{"version":3,"sources":["./src/app/invoice/invoice.component.ts","./src/app/invoice/invoice.component.html","./src/app/invoice/add-vehicle-dialog/add-vehicle-dialog.component.ts","./src/app/invoice/add-vehicle-dialog/add-vehicle-dialog.component.html","./src/app/invoice/bill-to-dialog/bill-to-dialog.component.ts","./src/app/invoice/bill-to-dialog/bill-to-dialog.component.html","./src/app/invoice/edit-vehicle-dialog/edit-vehicle-dialog.component.ts","./src/app/invoice/edit-vehicle-dialog/edit-vehicle-dialog.component.html","./src/app/invoice/new-invoice-dialog/new-invoice-dialog.component.ts","./src/app/invoice/new-invoice-dialog/new-invoice-dialog.component.html","./src/app/invoice/edit-invoice-dialog/edit-invoice-dialog.component.ts","./src/app/invoice/edit-invoice-dialog/edit-invoice-dialog.component.html","./src/app/business/services/invoice.service.ts","./src/app/invoice/invoice.module.ts","./src/app/invoice/ship-select-dialog/ship-select-dialog.component.ts","./src/app/invoice/ship-select-dialog/ship-select-dialog.component.html"],"names":[],"mappings":"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","file":"invoice-invoice-module-es2015.js","sourcesContent":["import { AfterContentInit, AfterViewInit, Component, DoCheck, OnDestroy, OnInit, ViewChild } from '@angular/core'\nimport { MatDialog } from '@angular/material/dialog'\nimport { MatPaginator } from '@angular/material/paginator'\nimport { MatSort } from '@angular/material/sort'\nimport { MatTable, MatTableDataSource } from '@angular/material/table'\nimport { Subscription } from 'rxjs'\nimport { InvoiceService } from '../business/services/invoice.service'\nimport { Invoice, InvoiceStatus } from '../business/models/invoice.models'\nimport { DialogService } from '../shared/dialogs/dialog.service'\nimport { AddVehicleDialogComponent, AddVehicleDialogData } from './add-vehicle-dialog/add-vehicle-dialog.component'\nimport { BillToDialogComponent, BillToDialogData } from './bill-to-dialog/bill-to-dialog.component'\nimport { NewInvoiceDialogComponent, NewInvoiceDialogData } from './new-invoice-dialog/new-invoice-dialog.component'\nimport { ShipSelectDialogComponent, ShipSelectDialogData } from './ship-select-dialog/ship-select-dialog.component'\nimport { InvoicesStateService } from '../business/state/invoice-state.service'\nimport { NotificationService } from '../shared/notifications/notification.service'\nimport { EditInvoiceDialogComponent, EditInvoiceDialogData } from './edit-invoice-dialog/edit-invoice-dialog.component'\nimport { EditVehicleDialogComponent, EditVehicleDialogData } from './edit-vehicle-dialog/edit-vehicle-dialog.component'\nimport { Vehicle } from '../business/models/vehicle.models'\nimport { AuthenticationService } from '../authentication/authentication.service'\n\n@Component({\n  selector: 'app-invoice',\n  templateUrl: './invoice.component.html',\n  styleUrls: ['./invoice.component.scss'],\n})\nexport class InvoiceComponent implements OnInit, AfterViewInit, OnDestroy {\n  @ViewChild(MatSort, { static: true }) sort: MatSort\n  @ViewChild(MatPaginator) paginator: MatPaginator\n  @ViewChild('table', { static: true }) table: MatTable<any>\n\n  auxPaginator: MatPaginator\n  paginatorPageIndex: number = 1\n  paginatorLength: number\n  paginatorPageSize: number = 12\n\n  subscriptions: Subscription[] = []\n  displayedColumns = ['_', 'driver', 'invoice_number', 'date', 'bill_to', 'ship_from', 'ship_to', 'amount', 'actions']\n  pageSizeOptions: number[] = [12, 24, 50, 100]\n  items: MatTableDataSource<any>\n  invoices: Invoice[]\n  tab: InvoiceStatus = 'DRAFT'\n  newInvoiceCurrentStep: 0 | 1 = 0\n  selectedInvoices: Invoice[] = []\n  allSelected = false\n  isAdmin: boolean\n\n  constructor(\n    public dialog: MatDialog,\n    private dialogService: DialogService,\n    private invoiceService: InvoiceService,\n    public invoiceState: InvoicesStateService,\n    private notificationService: NotificationService,\n    private authService: AuthenticationService\n  ) {\n    this.isAdmin = this.authService.isAdmin()\n    this.items = new MatTableDataSource([])\n    const sub = invoiceState.invoices$.subscribe((data) => {\n      this.allSelected = false\n      this.invoiceState.setAllSelectedInvoices([], false)\n      this.invoices = data\n      this.items.data = this.invoices\n    })\n    const sub2 = invoiceState.selectedInvoices$.subscribe((data) => {\n      this.selectedInvoices = data\n    })\n\n    this.subscriptions.push(sub, sub2)\n  }\n\n  ngOnInit() {\n    this.handleFetchInvoices(this.tab, this.paginatorPageSize, this.paginatorPageIndex)\n\n    //custom table filters\n    this.items.filterPredicate = (data: Invoice, filter: string) => {\n      return (\n        data.driver.first_name.toLowerCase().indexOf(filter) !== -1 ||\n        data.driver.last_name.toLowerCase().indexOf(filter) !== -1 ||\n        data.number?.toString().toLowerCase().indexOf(filter) !== -1 ||\n        data.bill_to?.name.toLowerCase().indexOf(filter) !== -1 ||\n        (data.ship_from || data.quick_ship_from)?.name.toLowerCase().indexOf(filter) !== -1 ||\n        (data.ship_to || data.quick_ship_to)?.name.toLowerCase().indexOf(filter) !== -1 ||\n        data.total.toString().toLowerCase().indexOf(filter) !== -1\n      )\n    }\n\n    //custom table sort\n    this.items.sortingDataAccessor = (item, property) => {\n      switch (property) {\n        case 'invoice_number':\n          return item.number\n        case 'date':\n          return new Date(item.date)\n        case 'driver':\n          return item.driver?.first_name + ' ' + item.driver?.last_name\n        default:\n          return item[property]\n      }\n    }\n    this.items.sort = this.sort\n  }\n\n  handlePage(e: any) {\n    console.log(e)\n    this.paginatorPageSize = e.pageSize\n    this.handleFetchInvoices(this.tab, e.pageSize, e.pageIndex + 1)\n  }\n\n  setTable(type: InvoiceStatus) {\n    this.paginatorPageIndex = 1\n    this.allSelected = false\n    this.invoiceState.setAllSelectedInvoices([], false)\n    this.tab = type\n    this.items.data = []\n    this.handleFetchInvoices(type, this.paginatorPageSize, this.paginatorPageIndex)\n  }\n\n  handleFetchInvoices(type: InvoiceStatus, pageSize: number, pageIndex: number) {\n    this.dialogService.showLoader()\n    this.invoiceService\n      .fetchInvoices(type, pageSize, pageIndex)\n      .then((data) => {\n        this.paginatorLength = data.totalResults\n      })\n      .finally(() => {\n        this.dialogService.hideLoader()\n      })\n  }\n\n  // setInvoices() {\n  //   this.items.data = this.invoices.filter((inv) => inv.status === this.tab)\n  // }\n\n  onEdit(invoice: Invoice) {\n    this.invoiceState.setSelectedInvoice(invoice)\n    this.openEditDialog()\n  }\n\n  openNewDialog() {\n    this.dialog.closeAll()\n    this.dialog.open<NewInvoiceDialogComponent, NewInvoiceDialogData>(NewInvoiceDialogComponent, {\n      width: '800px',\n      disableClose: true,\n      data: {\n        onBillTo: () => this.openBillToDialog(),\n        onShipFrom: () => this.openShipSelectDialog('FROM'),\n        onShipTo: () => this.openShipSelectDialog('TO'),\n        onAddVehicle: () => this.openAddVehicleDialog(),\n        onEditVehicle: (vehicle: Vehicle) => this.openEditVehicleDialog(vehicle),\n        onDeleteVehicle: (vehicle: Vehicle) =>\n          this.dialogService.showConfirm({ title: 'Delete vehicle', msg: 'Are you sure?' }, () => {\n            this.invoiceState.deleteNewInvoiceVehicle(vehicle._id)\n          }),\n        currentStep: this.newInvoiceCurrentStep,\n        setCurrentStep: (idx: 0 | 1) => {\n          this.newInvoiceCurrentStep = idx\n        },\n      },\n    })\n  }\n\n  openEditDialog() {\n    this.dialog.closeAll()\n    this.dialog.open<EditInvoiceDialogComponent, EditInvoiceDialogData>(EditInvoiceDialogComponent, {\n      width: '800px',\n      disableClose: true,\n      data: {\n        onBillTo: () => this.openBillToDialog('edit'),\n        onShipFrom: () => this.openShipSelectDialog('FROM', 'edit'),\n        onShipTo: () => this.openShipSelectDialog('TO', 'edit'),\n        onAddVehicle: () => this.openAddVehicleDialog('edit'),\n        onEditVehicle: (vehicle: Vehicle) => this.openEditVehicleDialog(vehicle, 'edit'),\n        onDeleteVehicle: (vehicle: Vehicle) =>\n          this.dialogService.showConfirm({ title: 'Delete vehicle', msg: 'Are you sure?' }, () => {\n            this.invoiceState.deleteSelectedInvoiceVehicle(vehicle._id)\n          }),\n        currentStep: this.newInvoiceCurrentStep,\n        setCurrentStep: (idx: 0 | 1) => {\n          this.newInvoiceCurrentStep = idx\n        },\n      },\n    })\n  }\n\n  openBillToDialog(action: 'edit' | 'new' = 'new') {\n    this.dialog.closeAll()\n    this.dialog.open<BillToDialogComponent, BillToDialogData>(BillToDialogComponent, {\n      width: '700px',\n      disableClose: true,\n      data: {\n        action,\n        onBackToInvoice: () => (action === 'edit' ? this.openEditDialog() : this.openNewDialog()),\n      },\n    })\n  }\n\n  openShipSelectDialog(type: 'FROM' | 'TO', action: 'edit' | 'new' = 'new') {\n    this.dialog.closeAll()\n    this.dialog.open<ShipSelectDialogComponent, ShipSelectDialogData>(ShipSelectDialogComponent, {\n      width: '700px',\n      disableClose: true,\n      data: {\n        onBackToInvoice: () => (action === 'edit' ? this.openEditDialog() : this.openNewDialog()),\n        //onCustomerQuickEntry: () => this.openCustomerQuickEntryDialog(),\n        type,\n        action,\n      },\n    })\n  }\n\n  openAddVehicleDialog(action: 'edit' | 'new' = 'new') {\n    this.dialog.closeAll()\n    this.dialog.open<AddVehicleDialogComponent, AddVehicleDialogData>(AddVehicleDialogComponent, {\n      width: '700px',\n      disableClose: true,\n      data: {\n        action,\n        onBackToInvoice: () => (action === 'edit' ? this.openEditDialog() : this.openNewDialog()),\n      },\n    })\n  }\n\n  openEditVehicleDialog(vehicle: Vehicle, action: 'edit' | 'new' = 'new') {\n    this.dialog.closeAll()\n    this.dialog.open<EditVehicleDialogComponent, EditVehicleDialogData>(EditVehicleDialogComponent, {\n      width: '700px',\n      disableClose: true,\n      data: {\n        action,\n        onBackToInvoice: () => (action === 'edit' ? this.openEditDialog() : this.openNewDialog()),\n        vehicle,\n        viewMode: this.tab != 'DRAFT' && this.tab != 'SUBMITTED_FOR_REVIEW',\n      },\n    })\n  }\n\n  onDelete(invoice: Invoice) {\n    this.dialogService.showConfirm({ title: 'Delete invoice', msg: 'Are you sure?' }, () => {\n      this.invoiceService.deleteInvoice(invoice.id).subscribe((res) => {\n        this.notificationService.success('Invoice deleted')\n      })\n    })\n  }\n\n  onSelectInvoice(e: any, invoice: Invoice) {\n    this.allSelected = false\n    this.invoiceState.setSelectedInvoices(invoice, e.target.checked)\n  }\n\n  onSelectAll(e: any) {\n    this.allSelected = true\n    this.invoiceState.setAllSelectedInvoices(this.items.filteredData, e.target.checked)\n  }\n\n  onSubmitToReview() {\n    if (!this.selectedInvoices?.length || this.selectedInvoices.some((inv) => inv.status !== 'DRAFT')) return\n    const invoiceIds = this.selectedInvoices.map((inv) => inv.id)\n    this.dialogService.showLoader()\n\n    this.invoiceService.submitDraftInvoices(invoiceIds).subscribe(\n      (res) => {\n        this.notificationService.success('Invoices submitted')\n        this.dialogService.hideLoader()\n      },\n      (err) => {\n        this.notificationService.error()\n        this.dialogService.hideLoader()\n      }\n    )\n  }\n\n  onSubmitToQB() {\n    if (!this.selectedInvoices?.length || this.selectedInvoices.some((inv) => inv.status !== 'SUBMITTED_FOR_REVIEW')) {\n      return\n    }\n    const invoiceIds = this.selectedInvoices.map((inv) => inv.id)\n    this.dialogService.showLoader()\n    this.invoiceService.submitInvoicesToQB(invoiceIds).subscribe(\n      (res: any) => {\n        if (res.status === 'warning') {\n          return this.notificationService.warning(res.msg)\n        }\n        this.notificationService.success('Invoices submitted')\n        this.dialogService.hideLoader()\n      },\n      (err) => {\n        this.notificationService.error()\n        this.dialogService.hideLoader()\n      }\n    )\n  }\n\n  onSubmitToPaid() {\n    if (!this.selectedInvoices?.length || this.selectedInvoices.some((inv) => inv.status !== 'SUBMITTED_TO_CUSTOMER'))\n      return\n    const invoiceIds = this.selectedInvoices.map((inv) => inv.id)\n    this.dialogService.showLoader()\n    this.invoiceService.submitInvoicesToPaid(invoiceIds).subscribe(\n      (res: any) => {\n        // if (res.status === \"warning\") {\n        //   return this.notificationService.warning(res.msg);\n        // }\n        this.notificationService.success('Invoices submitted')\n        this.dialogService.hideLoader()\n      },\n      (err) => {\n        this.notificationService.error()\n        this.dialogService.hideLoader()\n      }\n    )\n  }\n\n  onExportPdf() {\n    this.dialogService.showLoader()\n    this.invoiceService\n      .exportToPdf(this.selectedInvoices)\n      .catch(() => {\n        this.notificationService.error()\n      })\n      .finally(() => {\n        this.dialogService.hideLoader()\n      })\n  }\n\n  ngAfterViewInit() {\n    this.items.sort = this.sort\n    //this.items.paginator = this.paginator\n  }\n\n  applyFilter(filterValue: string) {\n    this.allSelected = false\n    this.invoiceState.setAllSelectedInvoices([], false)\n    this.items.filter = filterValue.trim().toLocaleLowerCase()\n  }\n\n  ngOnDestroy() {\n    this.subscriptions.forEach((sub) => sub.unsubscribe())\n  }\n}\n","<div class=\"px-2 px-md-5 py-3\">\n  <!-- content topbar -->\n  <div class=\"d-flex flex-wrap w-100 justify-content-between align-items-center mb-3\">\n    <h1 class=\"text-dark d-inline-block content-title\">Invoices</h1>\n    <div class=\"d-flex content-options-bar\">\n      <div class=\"input-group\">\n        <div class=\"input-group-prepend\">\n          <span class=\"input-group-text\">\n            <i class=\"fas fa-search\"></i>\n          </span>\n        </div>\n        <input\n          type=\"text\"\n          class=\"form-control\"\n          (keyup)=\"applyFilter($event.target.value)\"\n          placeholder=\"Filter by any field...\"\n        />\n      </div>\n      <button (click)=\"openNewDialog()\" class=\"btn font-weight-bold bg-blue-main text-light ml-3\" [disabled]=\"!isAdmin\">\n        +Add\n      </button>\n      <div ngbDropdown class=\"d-inline-block ml-3\">\n        <button class=\"btn btn-outline-primary\" *ngIf=\"this.selectedInvoices?.length\" ngbDropdownToggle>Actions</button>\n        <div ngbDropdownMenu>\n          <button *ngIf=\"tab === 'DRAFT'\" ngbDropdownItem (click)=\"onSubmitToReview()\">\n            <i class=\"far fa-paper-plane mr-2\"></i>\n            <span>Submit for review</span>\n          </button>\n          <button *ngIf=\"tab === 'SUBMITTED_FOR_REVIEW'\" ngbDropdownItem (click)=\"onSubmitToQB()\">\n            <i class=\"far fa-paper-plane mr-2\"></i>\n            <span>Submit to QB</span>\n          </button>\n          <button *ngIf=\"tab === 'SUBMITTED_TO_CUSTOMER'\" ngbDropdownItem (click)=\"onSubmitToPaid()\">\n            <i class=\"far fa-paper-plane mr-2\"></i>\n            <span>Submit to Paid</span>\n          </button>\n          <button ngbDropdownItem (click)=\"onExportPdf()\">\n            <i class=\"far fa-file-alt mr-2\"></i>\n            <span>Export PDF</span>\n          </button>\n        </div>\n      </div>\n    </div>\n  </div>\n\n  <!-- TABS NAV -->\n  <div class=\"nav-wrapper mb-4\">\n    <ul class=\"nav nav-pills nav-fill\">\n      <li class=\"nav-item cursor-pointer\" (click)=\"setTable('DRAFT')\">\n        <a class=\"nav-link\" [class.active]=\"tab === 'DRAFT'\">Driver drafts</a>\n      </li>\n      <li class=\"nav-item cursor-pointer\" (click)=\"setTable('SUBMITTED_FOR_REVIEW')\">\n        <a class=\"nav-link\" [class.active]=\"tab === 'SUBMITTED_FOR_REVIEW'\">Submitted for review</a>\n      </li>\n      <!-- <li class=\"nav-item cursor-pointer\" (click)=\"setTable('QUEUED_FOR_EXPORT')\">\n        <a class=\"nav-link\" [class.active]=\"tab === 'QUEUED_FOR_EXPORT'\">Queued for export</a>\n      </li> -->\n      <li class=\"nav-item cursor-pointer\" (click)=\"setTable('SUBMITTED_TO_CUSTOMER')\">\n        <a class=\"nav-link\" [class.active]=\"tab === 'SUBMITTED_TO_CUSTOMER'\">Submitted to customers</a>\n      </li>\n      <li class=\"nav-item cursor-pointer\" (click)=\"setTable('PAID')\">\n        <a class=\"nav-link\" [class.active]=\"tab === 'PAID'\">Paid</a>\n      </li>\n    </ul>\n  </div>\n\n  <!-- TABLE -->\n  <div class=\"row mb-4\">\n    <div class=\"col-12 table-wrapper table-responsive\">\n      <table mat-table [dataSource]=\"items\" class=\"table table-borderless table-striped\" matSort>\n        <ng-container matColumnDef=\"_\">\n          <th mat-header-cell *matHeaderCellDef>\n            <div class=\"custom-control custom-checkbox\" (change)=\"onSelectAll($event)\">\n              <input id=\"all-check\" type=\"checkbox\" class=\"custom-control-input\" [checked]=\"allSelected\" />\n              <label for=\"all-check\" class=\"custom-control-label\"></label>\n            </div>\n          </th>\n          <td mat-cell *matCellDef=\"let invoice\">\n            <div class=\"custom-control custom-checkbox\">\n              <input\n                type=\"checkbox\"\n                class=\"custom-control-input\"\n                [id]=\"invoice.id\"\n                [checked]=\"selectedInvoices.includes(invoice)\"\n                (change)=\"onSelectInvoice($event, invoice)\"\n              />\n              <label class=\"custom-control-label\" [for]=\"invoice.id\"></label>\n            </div>\n          </td>\n        </ng-container>\n\n        <ng-container matColumnDef=\"driver\">\n          <th mat-header-cell *matHeaderCellDef mat-sort-header>Driver</th>\n          <td mat-cell *matCellDef=\"let invoice\" class=\"capitalize\">\n            {{ invoice.driver?.first_name }} {{ invoice.driver?.last_name }}\n          </td>\n        </ng-container>\n\n        <ng-container matColumnDef=\"invoice_number\">\n          <th mat-header-cell *matHeaderCellDef mat-sort-header style=\"white-space: nowrap\">Invoice #</th>\n          <td mat-cell *matCellDef=\"let invoice\">{{ invoice.number }}</td>\n        </ng-container>\n\n        <ng-container matColumnDef=\"date\">\n          <th mat-header-cell *matHeaderCellDef mat-sort-header>Date</th>\n          <td mat-cell *matCellDef=\"let invoice\">{{ invoice.date | date: 'MM/dd/yyyy' }}</td>\n        </ng-container>\n\n        <ng-container matColumnDef=\"bill_to\">\n          <th mat-header-cell *matHeaderCellDef>Bill to</th>\n          <td mat-cell *matCellDef=\"let invoice\" style=\"min-width: 155px\">\n            {{ invoice.bill_to?.name }} <br />\n            {{ invoice.bill_to?.city?.name }}, {{ invoice.bill_to?.city?.state_code }}\n          </td>\n        </ng-container>\n\n        <ng-container matColumnDef=\"ship_from\">\n          <th mat-header-cell *matHeaderCellDef>Ship from</th>\n          <td mat-cell *matCellDef=\"let invoice\" style=\"min-width: 155px\">\n            {{ invoice.ship_from?.name || invoice.quick_ship_from?.name }} <br />\n            {{ invoice.ship_from?.city?.name || invoice.quick_ship_from?.city?.name }},\n            {{ invoice.ship_from?.city?.state_code || invoice.quick_ship_from?.city?.state_code }}\n          </td>\n        </ng-container>\n\n        <ng-container matColumnDef=\"ship_to\">\n          <th mat-header-cell *matHeaderCellDef>Ship to</th>\n          <td mat-cell *matCellDef=\"let invoice\" style=\"min-width: 155px\">\n            {{ invoice.ship_to?.name || invoice.quick_ship_to?.name }} <br />\n            {{ invoice.ship_to?.city?.name || invoice.quick_ship_to?.city?.name }},\n            {{ invoice.ship_to?.city?.state_code || invoice.quick_ship_to?.city?.state_code }}\n          </td>\n        </ng-container>\n\n        <ng-container matColumnDef=\"amount\">\n          <th mat-header-cell *matHeaderCellDef>Amount</th>\n          <td mat-cell *matCellDef=\"let invoice\">{{ invoice.total | currency }}</td>\n        </ng-container>\n\n        <ng-container matColumnDef=\"actions\">\n          <th mat-header-cell *matHeaderCellDef>Actions</th>\n          <td mat-cell *matCellDef=\"let invoice\">\n            <div *ngIf=\"tab == 'DRAFT' || tab == 'SUBMITTED_FOR_REVIEW'\" class=\"action-buttons\">\n              <button (click)=\"onEdit(invoice)\" class=\"text-dark mr-4\" aria-label=\"edit\">\n                <i class=\"fas fa-edit text-xl\"></i>\n              </button>\n              <button (click)=\"onDelete(invoice)\" class=\"text-dark\" aria-label=\"edit\">\n                <i class=\"fas fa-trash-alt text-xl\"></i>\n              </button>\n            </div>\n            <div *ngIf=\"tab != 'DRAFT' && tab != 'SUBMITTED_FOR_REVIEW'\" class=\"action-buttons justify-content-center\">\n              <button (click)=\"onEdit(invoice)\" class=\"text-dark mr-4\" aria-label=\"edit\">\n                <i class=\"fas fa-eye text-xl\"></i>\n              </button>\n            </div>\n          </td>\n        </ng-container>\n\n        <tr mat-header-row *matHeaderRowDef=\"displayedColumns\"></tr>\n        <tr mat-row *matRowDef=\"let row; columns: displayedColumns\"></tr>\n      </table>\n      <div *ngIf=\"!items.data.length || !items.filteredData.length\" class=\"table-width text-center border py-3 mt-n3\">\n        No invoices found\n      </div>\n      <mat-paginator\n        [length]=\"paginatorLength\"\n        [pageIndex]=\"paginatorPageIndex - 1\"\n        [pageSize]=\"paginatorPageSize\"\n        [pageSizeOptions]=\"pageSizeOptions\"\n        (page)=\"handlePage($event)\"\n        aria-label=\"Select page\"\n      ></mat-paginator>\n    </div>\n  </div>\n</div>\n","import { Component, Inject, OnDestroy, OnInit } from \"@angular/core\";\nimport { FormBuilder, FormGroup, Validators } from \"@angular/forms\";\nimport { MatDialogRef, MAT_DIALOG_DATA } from \"@angular/material/dialog\";\nimport { Subscription } from \"rxjs\";\nimport { Invoice } from \"src/app/business/models/invoice.models\";\nimport { Rate } from \"src/app/business/models/rate.models\";\nimport { VinData } from \"src/app/business/models/vehicle.models\";\nimport { RateService } from \"src/app/business/services/rate.service\";\nimport { VehicleService } from \"src/app/business/services/vehicle.service\";\nimport { InvoicesStateService } from \"src/app/business/state/invoice-state.service\";\nimport { NotificationService } from \"src/app/shared/notifications/notification.service\";\nimport { regexs } from \"../../core/config/constants\";\n\nexport interface AddVehicleDialogData {\n  action: \"new\" | \"edit\";\n  onBackToInvoice: (...args: any) => any;\n}\n\n@Component({\n  selector: \"app-add-vehicle-dialog\",\n  templateUrl: \"./add-vehicle-dialog.component.html\",\n  styleUrls: [\"./add-vehicle-dialog.component.scss\"],\n})\nexport class AddVehicleDialogComponent implements OnInit, OnDestroy {\n  subscriptions: Subscription[] = [];\n  vehicleForm: FormGroup;\n  years: number[] = [];\n  makes: string[] = [];\n  models: string[] = [];\n  rate: Rate;\n  vehicleSearched: VinData;\n  selectedInvoice: Partial<Invoice>;\n\n  constructor(\n    public dialogRef: MatDialogRef<AddVehicleDialogComponent>,\n    @Inject(MAT_DIALOG_DATA) public data: AddVehicleDialogData,\n    private fb: FormBuilder,\n    private vehicleService: VehicleService,\n    private invoicesState: InvoicesStateService,\n    private notificationService: NotificationService,\n    private rateService: RateService\n  ) {\n    this.buildForm();\n    const sub = this.invoicesState.selectedInvoice$.subscribe((data) => {\n      this.selectedInvoice = data;\n\n      const sub = this.rateService.rates.subscribe((rates) => {\n        const currentShipFromCity = (this.selectedInvoice?.ship_from || this.selectedInvoice?.quick_ship_from)?.city;\n        const currentShipToCity = (this.selectedInvoice?.ship_to || this.selectedInvoice?.quick_ship_to)?.city;\n\n        this.rate = rates.find((rt) => {\n          return (\n            `${rt.origination_city.name}_${rt.origination_city.state_code}_${rt.destination_city.name}_${rt.destination_city.state_code}` ===\n            `${currentShipFromCity?.name}_${currentShipFromCity?.state_code}_${currentShipToCity?.name}_${currentShipToCity?.state_code}`\n          );\n        });\n        if (this.rate?.amount) {\n          this.vehicleForm.controls.amount.setValue(this.rate.amount);\n        }\n      });\n\n      this.subscriptions.push(sub);\n\n      if (!this.rateService.rates.value?.length) {\n        this.rateService.fetchRates();\n      }\n    });\n    this.subscriptions.push(sub);\n  }\n\n  ngOnInit() {\n    this.years = this.vehicleService.years\n  }\n\n  onSelectYear(event: any) {\n    //TODO: get makes by year\n    this.makes = this.vehicleService.makes;\n  }\n\n  async onSelectMake(event: any) {\n    this.models = await this.vehicleService.getModelsByMake(event.target.value);\n    this.vehicleForm.controls.model.setValue(\"\")\n  }\n\n  buildForm() {\n    this.vehicleForm = this.fb.group({\n      vin: [\"\", [Validators.required, Validators.pattern(regexs.vin)]],\n      year: [\"\", [Validators.required]],\n      make: [\"\", [Validators.required]],\n      model: [\"\", [Validators.required]],\n      amount: [\"\", [Validators.required]],\n      weight: [\"\", []],\n      comments: [\"\", []],\n    });\n  }\n\n  onSearchVin(e: any) {\n    const vin = e.target.value;\n\n    if (this.vehicleForm.controls.vin.valid) {\n      this.vehicleService\n        .searchVin(vin.toUpperCase())\n        .then((data) => {\n          this.vehicleSearched = data;\n          this.makes.push(data.make);\n          this.models.push(data.model);\n          this.vehicleForm.controls.year.setValue(data.year);\n          this.vehicleForm.controls.make.setValue(data.make);\n          this.vehicleForm.controls.model.setValue(data.model);\n          this.vehicleForm.controls.weight.setValue(data.weight);\n        })\n        .catch((err) => {\n          this.vehicleSearched = null;\n          this.vehicleForm.controls.vin.setErrors({ faliedSearch: true });\n          this.vehicleForm.controls.vin.markAsTouched();\n        });\n    }\n  }\n\n  onSubmit() {\n    const vinControl = this.vehicleForm.controls.vin;\n    vinControl.setValue(vinControl.value?.toUpperCase());\n\n    if (this.vehicleForm.invalid) {\n      return Object.values(this.vehicleForm.controls).forEach((control) => {\n        if (control instanceof FormGroup) {\n          Object.values(control.controls).forEach((control) => control.markAsTouched());\n        } else {\n          control.markAsTouched();\n        }\n      });\n    } else {\n      try {\n        if (this.data.action === \"edit\") {\n          this.invoicesState.addSelectedInvoiceVehicle(this.vehicleForm.value);\n        } else {\n          this.invoicesState.addNewInvoiceVehicle(this.vehicleForm.value);\n        }\n      } catch (error) {\n        return this.notificationService.error(error.message);\n      }\n      this.data.onBackToInvoice();\n    }\n  }\n\n  ngOnDestroy() {\n    this.subscriptions.forEach((sub) => sub.unsubscribe());\n  }\n}\n","<h3>Add vehicle</h3>\n\n<form class=\"form-group\" [formGroup]=\"vehicleForm\" (ngSubmit)=\"onSubmit()\">\n  <div class=\"w-100 input-group pt-2 mb-3\">\n    <div class=\"input-group-prepend\">\n      <span class=\"input-group-text\">\n        <i class=\"fas fa-search\"></i>\n      </span>\n    </div>\n    <input\n      (input)=\"onSearchVin($event)\"\n      type=\"text\"\n      class=\"form-control\"\n      placeholder=\"Search VIN...\"\n      formControlName=\"vin\"\n      [class.is-invalid]=\"vehicleForm.controls.vin.touched && vehicleForm.controls.vin.invalid\"\n      [class.is-valid]=\"!!this.vehicleSearched\"\n    />\n    <div class=\"form-text invalid-feedback\" *ngIf=\"true\">\n      {{vehicleForm.controls.vin.errors?.faliedSearch ? \"VIN not found\" : \"Invalid VIN\" }}\n    </div>\n  </div>\n\n  <div class=\"w-100 mb-3\">\n    <label for=\"year\" class=\"text-dark text-base\">Year</label>\n    <div class=\"custom-select-wrapper\">\n      <select\n        class=\"custom-select form-control\"\n        formControlName=\"year\"\n        [class.is-invalid]=\"vehicleForm.controls.year.touched && vehicleForm.controls.year.invalid\"\n        (change)=\"onSelectYear($event)\"\n      >\n        <option disabled value=\"\">Select year...</option>\n        <option *ngFor=\"let year of years\" [value]=\"year\">{{ year }}</option>\n      </select>\n      <mat-icon class=\"half-arrow-icon\" svgIcon=\"half-arrow-down\"></mat-icon>\n    </div>\n  </div>\n\n  <div class=\"w-100 mb-3\">\n    <label for=\"make\" class=\"text-dark text-base\">Make</label>\n    <div class=\"custom-select-wrapper\">\n      <select\n        class=\"custom-select form-control\"\n        formControlName=\"make\"\n        [class.is-invalid]=\"vehicleForm.controls.make.touched && vehicleForm.controls.make.invalid\"\n        (change)=\"onSelectMake($event)\"\n      >\n        <option disabled value=\"\">Select make...</option>\n        <option *ngFor=\"let make of makes\" [value]=\"make\">{{ make }}</option>\n      </select>\n      <mat-icon class=\"half-arrow-icon\" svgIcon=\"half-arrow-down\"></mat-icon>\n    </div>\n  </div>\n\n  <div class=\"w-100 mb-3\">\n    <label for=\"model\" class=\"text-dark text-base\">Model</label>\n    <div class=\"custom-select-wrapper\">\n      <select\n        class=\"custom-select form-control\"\n        formControlName=\"model\"\n        [class.is-invalid]=\"vehicleForm.controls.model.touched && vehicleForm.controls.model.invalid\"\n      >\n        <option disabled value=\"\">Select model...</option>\n        <option *ngFor=\"let model of models\" [value]=\"model\">{{ model }}</option>\n      </select>\n      <mat-icon class=\"half-arrow-icon\" svgIcon=\"half-arrow-down\"></mat-icon>\n    </div>\n  </div>\n\n  <div class=\"w-100 mb-3\">\n    <label for=\"amount\" class=\"text-dark text-base\">Amount</label>\n    <div class=\"input-group\">\n      <div class=\"input-group-prepend\">\n        <span class=\"input-group-text\"> $ </span>\n      </div>\n      <input\n        type=\"number\"\n        class=\"form-control\"\n        placeholder=\"Amount...\"\n        formControlName=\"amount\"\n        [class.is-invalid]=\"vehicleForm.controls.amount.touched && vehicleForm.controls.amount.invalid\"\n      />\n    </div>\n  </div>\n\n  <div class=\"w-100 mb-3\">\n    <label for=\"weight\" class=\"text-dark text-base\">Weight</label>\n    <div class=\"input-group\">\n      <div class=\"input-group-prepend\">\n        <span class=\"input-group-text\"> Kg </span>\n      </div>\n      <input\n        type=\"number\"\n        class=\"form-control\"\n        placeholder=\"Weight...\"\n        formControlName=\"weight\"\n        [class.is-invalid]=\"vehicleForm.controls.weight.touched && vehicleForm.controls.weight.invalid\"\n      />\n    </div>\n  </div>\n\n  <div class=\"w-100\">\n    <label for=\"comments\" class=\"text-dark text-base\">Comments</label>\n    <textarea\n      class=\"form-control\"\n      id=\"textarea\"\n      maxlength=\"256\"\n      rows=\"3\"\n      formControlName=\"comments\"\n      [class.is-invalid]=\"vehicleForm.controls.comments.touched && vehicleForm.controls.comments.invalid\"\n    ></textarea>\n  </div>\n\n  <div class=\"d-flex w-100 px-4 pt-3 justify-content-between mt-3\">\n    <div class=\"col-5\">\n      <button class=\"btn w-100 btn-outline-secondary\" type=\"button\" (click)=\"data.onBackToInvoice()\">Cancel</button>\n    </div>\n    <div class=\"col-5\">\n      <button class=\"btn w-100 btn-success\">Add</button>\n    </div>\n  </div>\n</form>\n","import { Component, Inject, OnDestroy, OnInit } from \"@angular/core\";\nimport { MatDialogRef, MAT_DIALOG_DATA } from \"@angular/material/dialog\";\nimport { CustomerService } from \"src/app/business/services/customer.service\";\nimport { Customer } from \"src/app/business/models/customer.models\";\nimport { InvoicesStateService } from \"src/app/business/state/invoice-state.service\";\nimport { Subscription } from \"rxjs\";\n\nexport interface BillToDialogData {\n  action: \"new\" | \"edit\";\n  onBackToInvoice: (...args: any) => any;\n}\n\n@Component({\n  selector: \"app-bill-to-dialog\",\n  templateUrl: \"./bill-to-dialog.component.html\",\n  styleUrls: [\"./bill-to-dialog.component.scss\"],\n})\nexport class BillToDialogComponent implements OnInit, OnDestroy {\n  subscriptions: Subscription[] = [];\n  foundCustomers: Customer[] = [];\n  mostRecentsCustomers: Customer[] = [];\n\n  constructor(\n    public dialogRef: MatDialogRef<BillToDialogComponent>,\n    @Inject(MAT_DIALOG_DATA) public data: BillToDialogData,\n    public customerService: CustomerService,\n    private invoicesState: InvoicesStateService\n  ) {}\n\n  backToInvoice() {\n    this.data.onBackToInvoice();\n  }\n\n  ngOnInit() {\n    const sub = this.invoicesState.mostRecentsCustomers$.subscribe((data) => {\n      this.mostRecentsCustomers = data;\n    });\n    this.subscriptions.push(sub);\n  }\n\n  async searchCustomers(e: any) {\n    const query = e.target.value;\n    this.foundCustomers = await this.customerService.searchCustomers(query);\n  }\n\n  onSelect(customer: Customer) {\n    if (this.data.action === \"edit\") {\n      this.invoicesState.setSelectedInvoice({ bill_to: customer });\n    } else {\n      this.invoicesState.setNewInvoice({ bill_to: customer });\n    }\n    this.data.onBackToInvoice();\n  }\n\n  ngOnDestroy() {\n    this.subscriptions.forEach((sub) => sub.unsubscribe());\n  }\n}\n","<h3>Bill to</h3>\n\n<div class=\"input-group pt-3\">\n  <div class=\"input-group-prepend\">\n    <span class=\"input-group-text\">\n      <i class=\"fas fa-search\"></i>\n    </span>\n  </div>\n  <input type=\"text\" class=\"form-control\" placeholder=\"Search customer...\" (input)=\"searchCustomers($event)\" />\n  <div class=\"w-100 text-secondary text-sm\">Min 3 characters</div>\n</div>\n\n<div class=\"w-100 my-3 table-wrapper table-responsive custom-scroll\">\n  <table class=\"table table-sm table-bordered\">\n    <thead>\n      <tr>\n        <th scope=\"col\">Customer list</th>\n      </tr>\n    </thead>\n    <tbody>\n      <div class=\"w-100 text-center\" *ngIf=\"!foundCustomers?.length\">\n        <p class=\"border py-2\">No customers found</p>\n      </div>\n      <tr *ngFor=\"let customer of foundCustomers\" (click)=\"onSelect(customer)\">\n        <td>{{ customer.name }}</td>\n      </tr>\n    </tbody>\n  </table>\n</div>\n\n<div class=\"w-100 my-3 table-wrapper table-responsive custom-scroll\">\n  <table class=\"table table-sm table-bordered\">\n    <thead>\n      <tr>\n        <th scope=\"col\">Most recent</th>\n      </tr>\n    </thead>\n    <tbody>\n      <!-- <div class=\"w-100 text-center\">\n        <p class=\"border py-2\">No customers found</p>\n      </div> -->\n      <div class=\"w-100 text-center\" *ngIf=\"!mostRecentsCustomers?.length\">\n        <p class=\"border py-2\">No customers found</p>\n      </div>\n      <tr *ngFor=\"let customer of mostRecentsCustomers\" (click)=\"onSelect(customer)\">\n        <td>{{ customer.name }}</td>\n      </tr>\n    </tbody>\n  </table>\n</div>\n\n<div class=\"w-100 mt-3\">\n  <button class=\"w-100 btn btn-outline-primary\" (click)=\"backToInvoice()\">Back to invoice</button>\n</div>\n","import { Component, Inject, OnDestroy, OnInit } from \"@angular/core\";\nimport { FormBuilder, FormGroup, Validators } from \"@angular/forms\";\nimport { MatDialogRef, MAT_DIALOG_DATA } from \"@angular/material/dialog\";\nimport { Subscription } from \"rxjs\";\nimport { Rate } from \"src/app/business/models/rate.models\";\nimport { Vehicle, VinData } from \"src/app/business/models/vehicle.models\";\nimport { VehicleService } from \"src/app/business/services/vehicle.service\";\nimport { InvoicesStateService } from \"src/app/business/state/invoice-state.service\";\nimport { regexs } from \"src/app/core/config/constants\";\nimport { NotificationService } from \"src/app/shared/notifications/notification.service\";\n\nexport interface EditVehicleDialogData {\n  action: \"new\" | \"edit\";\n  onBackToInvoice: (...args: any) => any;\n  vehicle: Vehicle;\n  viewMode: boolean;\n}\n\n@Component({\n  selector: \"app-edit-vehicle-dialog\",\n  templateUrl: \"./edit-vehicle-dialog.component.html\",\n  styleUrls: [\"./edit-vehicle-dialog.component.scss\"],\n})\nexport class EditVehicleDialogComponent implements OnInit, OnDestroy {\n  subscriptions: Subscription[] = [];\n  vehicleForm: FormGroup;\n  years: number[] = [];\n  makes: string[] = [];\n  models: string[] = [];\n  rate: Rate;\n  vehicleSearched: VinData;\n  viewMode: boolean;\n\n  constructor(\n    public dialogRef: MatDialogRef<EditVehicleDialogComponent>,\n    @Inject(MAT_DIALOG_DATA) public data: EditVehicleDialogData,\n    private fb: FormBuilder,\n    private vehicleService: VehicleService,\n    private invoicesState: InvoicesStateService,\n    private notificationService: NotificationService\n  ) {\n    this.viewMode = this.data.viewMode;\n    this.buildForm();\n    const sub = this.invoicesState.currentRate$.subscribe((rate) => {\n      this.rate = rate;\n      if (rate?.amount) {\n        this.vehicleForm.controls.amount.setValue(rate.amount);\n      }\n    });\n    this.subscriptions.push(sub);\n  }\n\n  ngOnInit() {\n    this.years = this.vehicleService.years;\n    this.makes = this.vehicleService.makes;\n    this.makes.push(this.data.vehicle.make);\n    this.models.push(this.data.vehicle.model);\n    this.getModels(this.data.vehicle.make);\n    //TODO: get models by make ande year\n  }\n\n  onSelectYear(event: any) {\n    //TODO: get makes by year\n    //this.makes = this.vehicleService.makes;\n  }\n\n  onSelectMake(event: any) {\n    this.getModels(event.target.value);\n    this.vehicleForm.controls.model.setValue(\"\");\n  }\n\n  async getModels(make: string) {\n    this.models = await this.vehicleService.getModelsByMake(make);\n  }\n\n  buildForm() {\n    this.vehicleForm = this.fb.group({\n      vin: [{ value: this.data.vehicle.vin, disabled: this.viewMode }, [Validators.required, Validators.pattern(regexs.vin)]],\n      year: [{ value: this.data.vehicle.year, disabled: this.viewMode }, [Validators.required]],\n      make: [{ value: this.data.vehicle.make, disabled: this.viewMode }, [Validators.required]],\n      model: [{ value: this.data.vehicle.model, disabled: this.viewMode }, [Validators.required]],\n      amount: [{ value: this.data.vehicle.amount, disabled: this.viewMode }, [Validators.required]],\n      weight: [{ value: this.data.vehicle.weight, disabled: this.viewMode }, []],\n      comments: [{ value: this.data.vehicle.comments, disabled: this.viewMode }, []],\n    });\n  }\n\n  async onSearchVin(e: any) {\n    const vin = e.target.value;\n\n    if (this.vehicleForm.controls.vin.valid) {\n      this.vehicleService\n        .searchVin(vin.toUpperCase())\n        .then((data) => {\n          this.vehicleSearched = data;\n          this.makes.push(data.make);\n          this.models.push(data.model);\n          this.vehicleForm.controls.year.setValue(data.year);\n          this.vehicleForm.controls.make.setValue(data.make);\n          this.vehicleForm.controls.model.setValue(data.model);\n          this.vehicleForm.controls.weight.setValue(data.weight);\n        })\n        .catch((err) => {\n          this.vehicleSearched = null;\n          this.vehicleForm.controls.vin.setErrors({ faliedSearch: true });\n          this.vehicleForm.controls.vin.markAsTouched();\n        });\n    }\n  }\n\n  onSubmit() {\n    const vinControl = this.vehicleForm.controls.vin;\n    vinControl.setValue(vinControl.value?.toUpperCase());\n\n    if (this.vehicleForm.invalid) {\n      return Object.values(this.vehicleForm.controls).forEach((control) => {\n        if (control instanceof FormGroup) {\n          Object.values(control.controls).forEach((control) => control.markAsTouched());\n        } else {\n          control.markAsTouched();\n        }\n      });\n    } else {\n      try {\n        if (this.data.action === \"edit\") {\n          this.invoicesState.editSelectedInvoiceVehicle(this.vehicleForm.value, this.data.vehicle?._id);\n        } else {\n          this.invoicesState.editNewInvoiceVehicle(this.vehicleForm.value, this.data.vehicle?._id);\n        }\n      } catch (error) {\n        return this.notificationService.error(error.message);\n      }\n      this.data.onBackToInvoice();\n    }\n  }\n\n  ngOnDestroy() {\n    this.subscriptions.forEach((sub) => sub.unsubscribe());\n  }\n}\n","<h3>{{ !viewMode ? 'Edit vehicle' : 'Vehicle' }}</h3>\n\n<form class=\"form-group\" [formGroup]=\"vehicleForm\" (ngSubmit)=\"onSubmit()\">\n    <div class=\"w-100 input-group pt-2 mb-3\">\n        <div class=\"input-group-prepend\">\n            <span class=\"input-group-text\">\n                <i class=\"fas fa-search\"></i>\n            </span>\n        </div>\n        <input\n            (input)=\"onSearchVin($event)\"\n            type=\"text\"\n            class=\"form-control\"\n            placeholder=\"Search VIN...\"\n            formControlName=\"vin\"\n            [class.is-invalid]=\"vehicleForm.controls.vin.touched && vehicleForm.controls.vin.invalid\"\n            [class.is-valid]=\"!!this.vehicleSearched\"\n        />\n        <div class=\"form-text invalid-feedback\" *ngIf=\"true\">\n            {{ vehicleForm.controls.vin.errors?.faliedSearch ? 'VIN not found' : 'Invalid VIN' }}\n        </div>\n    </div>\n\n    <div class=\"w-100 mb-3\">\n        <label for=\"year\" class=\"text-dark text-base\">Year</label>\n        <div class=\"custom-select-wrapper\">\n            <select\n                class=\"custom-select form-control\"\n                formControlName=\"year\"\n                [class.is-invalid]=\"vehicleForm.controls.year.touched && vehicleForm.controls.year.invalid\"\n                (change)=\"onSelectYear($event)\"\n            >\n                <option disabled value=\"\">Select year...</option>\n                <option *ngFor=\"let year of years\" [value]=\"year\">{{ year }}</option>\n            </select>\n            <mat-icon class=\"half-arrow-icon\" svgIcon=\"half-arrow-down\"></mat-icon>\n        </div>\n    </div>\n\n    <div class=\"w-100 mb-3\">\n        <label for=\"make\" class=\"text-dark text-base\">Make</label>\n        <div class=\"custom-select-wrapper\">\n            <select\n                class=\"custom-select form-control\"\n                formControlName=\"make\"\n                [class.is-invalid]=\"vehicleForm.controls.make.touched && vehicleForm.controls.make.invalid\"\n                (change)=\"onSelectMake($event)\"\n            >\n                <option disabled value=\"\">Select make...</option>\n                <option *ngFor=\"let make of makes\" [value]=\"make\">{{ make }}</option>\n            </select>\n            <mat-icon class=\"half-arrow-icon\" svgIcon=\"half-arrow-down\"></mat-icon>\n        </div>\n    </div>\n\n    <div class=\"w-100 mb-3\">\n        <label for=\"model\" class=\"text-dark text-base\">Model</label>\n        <div class=\"custom-select-wrapper\">\n            <select\n                class=\"custom-select form-control\"\n                formControlName=\"model\"\n                [class.is-invalid]=\"vehicleForm.controls.model.touched && vehicleForm.controls.model.invalid\"\n            >\n                <option disabled value=\"\">Select model...</option>\n                <option *ngFor=\"let model of models\" [value]=\"model\">{{ model }}</option>\n            </select>\n            <mat-icon class=\"half-arrow-icon\" svgIcon=\"half-arrow-down\"></mat-icon>\n        </div>\n    </div>\n\n    <div class=\"w-100 mb-3\">\n        <label for=\"amount\" class=\"text-dark text-base\">Amount</label>\n        <div class=\"input-group\">\n            <div class=\"input-group-prepend\">\n                <span class=\"input-group-text\"> $ </span>\n            </div>\n            <input\n                type=\"number\"\n                class=\"form-control\"\n                placeholder=\"Amount...\"\n                formControlName=\"amount\"\n                [class.is-invalid]=\"vehicleForm.controls.amount.touched && vehicleForm.controls.amount.invalid\"\n            />\n        </div>\n    </div>\n\n    <div class=\"w-100 mb-3\">\n        <label for=\"weight\" class=\"text-dark text-base\">Weight</label>\n        <div class=\"input-group\">\n            <div class=\"input-group-prepend\">\n                <span class=\"input-group-text\"> Kg </span>\n            </div>\n            <input\n                type=\"number\"\n                class=\"form-control\"\n                placeholder=\"Weight...\"\n                formControlName=\"weight\"\n                [class.is-invalid]=\"vehicleForm.controls.weight.touched && vehicleForm.controls.weight.invalid\"\n            />\n        </div>\n    </div>\n\n    <div class=\"w-100\">\n        <label for=\"comments\" class=\"text-dark text-base\">Comments</label>\n        <textarea\n            class=\"form-control\"\n            id=\"textarea\"\n            maxlength=\"256\"\n            rows=\"3\"\n            formControlName=\"comments\"\n            [class.is-invalid]=\"vehicleForm.controls.comments.touched && vehicleForm.controls.comments.invalid\"\n        ></textarea>\n    </div>\n\n    <div *ngIf=\"!viewMode\" class=\"d-flex w-100 px-4 pt-3 justify-content-between mt-3\">\n        <div class=\"col-5\">\n            <button class=\"btn w-100 btn-outline-secondary\" type=\"button\" (click)=\"data.onBackToInvoice()\">\n                Cancel\n            </button>\n        </div>\n        <div class=\"col-5\">\n            <button class=\"btn w-100 btn-success\" type=\"submit\">Save</button>\n        </div>\n    </div>\n\n    <div *ngIf=\"viewMode\" class=\"d-flex w-100 px-4 pt-3 justify-content-center mt-3\">\n        <div class=\"col-5\">\n            <button class=\"btn w-100 btn-outline-secondary\" type=\"button\" (click)=\"data.onBackToInvoice()\">Back</button>\n        </div>\n    </div>\n</form>\n","import { StepperSelectionEvent } from \"@angular/cdk/stepper\";\nimport { Component, Inject, OnDestroy, OnInit } from \"@angular/core\";\nimport { MatDialogRef, MAT_DIALOG_DATA } from \"@angular/material/dialog\";\nimport { Subscription } from \"rxjs\";\nimport { Invoice, InvoiceBody, InvoiceStatus } from \"src/app/business/models/invoice.models\";\nimport { User } from \"src/app/business/models/user.models\";\nimport { Vehicle } from \"src/app/business/models/vehicle.models\";\nimport { CustomerService } from \"src/app/business/services/customer.service\";\nimport { InvoiceService } from \"src/app/business/services/invoice.service\";\nimport { RateService } from \"src/app/business/services/rate.service\";\nimport { UserService } from \"src/app/business/services/user.service\";\nimport { InvoicesStateService } from \"src/app/business/state/invoice-state.service\";\nimport { NotificationService } from \"src/app/shared/notifications/notification.service\";\n\nexport interface NewInvoiceDialogData {\n  onBillTo: (...args: any) => any;\n  onShipFrom: (...args: any) => any;\n  onShipTo: (...args: any) => any;\n  onAddVehicle: (...args: any) => any;\n  onEditVehicle: (vehicle: Vehicle) => any;\n  onDeleteVehicle: (vehicle: Vehicle) => any;\n  currentStep: 0 | 1;\n  setCurrentStep: (idx: 0 | 1) => any;\n}\n\ninterface Statuses {\n  value: InvoiceStatus;\n  label: string;\n}\n\nconst statuses: Statuses[] = [\n  { value: \"DRAFT\", label: \"Draft\" },\n  { value: \"SUBMITTED_FOR_REVIEW\", label: \"Submitted for review\" },\n  // { value: \"SUBMITTED_TO_CUSTOMER\", label: \"Submitted to customers\" },\n  // { value: \"PAID\", label: \"Paid\" },\n];\n\n@Component({\n  selector: \"app-new-invoice-dialog\",\n  templateUrl: \"./new-invoice-dialog.component.html\",\n  styleUrls: [\"./new-invoice-dialog.component.scss\"],\n})\nexport class NewInvoiceDialogComponent implements OnInit, OnDestroy {\n  subscriptions: Subscription[] = [];\n  drivers: User[];\n  statuses: Statuses[] = statuses;\n  invoice: Partial<Invoice>;\n  isLoading = false;\n\n  constructor(\n    public dialogRef: MatDialogRef<NewInvoiceDialogComponent>,\n    @Inject(MAT_DIALOG_DATA) public data: NewInvoiceDialogData,\n    private userService: UserService,\n    public invoicesState: InvoicesStateService,\n    private rateService: RateService,\n    private notificationService: NotificationService,\n    private invoiceService: InvoiceService,\n    private customerService: CustomerService\n  ) {\n    const sub1 = this.userService.users.subscribe((data) => {\n      this.drivers = data;\n    });\n    const sub2 = this.invoicesState.newInvoice$.subscribe((invoice) => {\n      this.invoice = invoice;\n    });\n    this.subscriptions.push(sub1, sub2);\n  }\n\n  ngOnInit() {\n    this.userService.fetchUsers();\n\n    const sub = this.customerService.getMostRecents().subscribe((data) => {\n      this.invoicesState.setMostRecentsCustomers(data);\n    });\n    this.subscriptions.push(sub);\n  }\n\n  onSelectDriver(event: any) {\n    this.invoicesState.setNewInvoice({ driver: this.drivers.find((d) => d.id === event.target.value) });\n  }\n\n  onSelectStatus(event: any) {\n    this.invoicesState.setNewInvoice({ status: event.target.value });\n  }\n\n  onStepChange(event: StepperSelectionEvent) {\n    this.data.setCurrentStep(event.selectedIndex as 0 | 1);\n    if (event.selectedIndex === 1) {\n      //get current rate\n      const from: any = this.invoice?.ship_from ?? {};\n      const to: any = this.invoice?.ship_to ?? {};\n      const code = `${from.city?.name}_${from.city?.state_code}_${to.city?.name}_${to.city?.state_code}`;\n      this.rateService.getRateByCode(code).subscribe((rate) => {\n        this.invoicesState.setCurretRate(rate);\n      });\n    }\n  }\n\n  getSubTotal() {\n    let subtotal = 0;\n    this.invoice?.vehicles?.forEach((v) => {\n      subtotal += v.amount;\n    });\n    return subtotal;\n  }\n\n  getTotal() {\n    let total = 0;\n    this.invoice?.vehicles?.forEach((v) => {\n      total += v.amount;\n    });\n    return total;\n  }\n\n  getWeight() {\n    let weight = 0;\n    this.invoice?.vehicles?.forEach((v) => {\n      weight += Number(v.weight);\n    });\n    return weight;\n  }\n\n  getDriverCommissionAmount() {\n    const total = this.getSubTotal();\n    const driverCommission = this.invoice?.driver?.commission ?? 0;\n    const amount = total * (driverCommission / 100);\n    return amount;\n  }\n\n  onSubmit() {\n    if (\n      !this.invoice?.driver ||\n      !this.invoice?.status ||\n      !this.invoice?.bill_to ||\n      !(this.invoice?.ship_from ?? this.invoice?.quick_ship_from) ||\n      !(this.invoice?.ship_to ?? this.invoice?.quick_ship_to)\n    ) {\n      this.notificationService.error(\"Missed fields required\");\n      return;\n    }\n\n    if (!this.invoice?.vehicles?.length) {\n      this.notificationService.error(\"Missed vehicles required\");\n      return;\n    }\n\n    const body: InvoiceBody = {\n      bill_to: this.invoice.bill_to.id,\n      ship_from: this.invoice.ship_from?.id,\n      ship_to: this.invoice.ship_to?.id,\n      quick_ship_from: this.invoice.quick_ship_from,\n      quick_ship_to: this.invoice.quick_ship_to,\n      driver_id: this.invoice.driver.id,\n      status: this.invoice.status,\n      vehicles: this.invoice.vehicles?.map(({ _id, ...rest }) => rest),\n    };\n\n    this.isLoading = true;\n    this.invoiceService.saveInvoice(body).subscribe(\n      (res) => {\n        this.isLoading = false;\n        this.notificationService.success(\"Invoice saved\");\n        this.dialogRef.close();\n        this.invoicesState.resetNewInvoice();\n      },\n      (err) => {\n        this.notificationService.error();\n        this.isLoading = false;\n      }\n    );\n  }\n\n  onCancel() {\n    this.invoicesState.resetNewInvoice();\n    this.data.setCurrentStep(0);\n    this.dialogRef.close();\n  }\n\n  ngOnDestroy() {\n    this.subscriptions.forEach((sub) => sub.unsubscribe());\n  }\n}\n","<div class=\"dialog-content custom-scroll\">\n  <div *ngIf=\"isLoading\" class=\"dialog-loader\">\n    <mat-spinner [diameter]=\"50\"></mat-spinner>\n  </div>\n  <h3>New Invoice</h3>\n\n  <form class=\"form-group w-100 mt-3 new-invoice-form mb-2\">\n    <div class=\"col-12 d-flex justify-content-between mb-3 text-xl\">\n      <span> Invoice #: ----</span>\n      <span>Date: ----</span>\n    </div>\n\n    <div class=\"col-12 mb-3\">\n      <label for=\"driver\" class=\"text-dark text-base\">Driver</label>\n      <div class=\"custom-select-wrapper\">\n        <select class=\"custom-select form-control\" (change)=\"onSelectDriver($event)\">\n          <option *ngIf=\"!invoice?.driver\" selected disabled value=\"\">Select driver...</option>\n          <option *ngFor=\"let driver of drivers\" [value]=\"driver.id\" [selected]=\"driver.id === invoice?.driver\">\n            <span>{{ driver.first_name | titlecase }} {{ driver.last_name | titlecase }}</span> - {{ driver.email }}\n          </option>\n        </select>\n        <mat-icon class=\"half-arrow-icon\" svgIcon=\"half-arrow-down\"></mat-icon>\n      </div>\n    </div>\n\n    <div class=\"col-12 mb-3\">\n      <label for=\"status\" class=\"text-dark text-base\">Status</label>\n      <div class=\"custom-select-wrapper\">\n        <select class=\"custom-select form-control\" (change)=\"onSelectStatus($event)\">\n          <option *ngFor=\"let status of statuses\" [value]=\"status.value\" [selected]=\"invoice?.status && status.value === invoice?.status\">\n            {{ status.label }}\n          </option>\n        </select>\n        <mat-icon class=\"half-arrow-icon\" svgIcon=\"half-arrow-down\"></mat-icon>\n      </div>\n    </div>\n\n    <div class=\"mt-2 w-100\">\n      <div class=\"col-12 d-flex flex-column align-items-start flex-md-row align-items-md-center mb-3\">\n        <button type=\"button\" class=\"flex-shrink-0 btn btn-primary mr-3 cust-btn\" (click)=\"data.onBillTo()\">Bill To</button>\n        <span class=\"bg-grey-light flex-grow-1 h-100 p-2 rounded-lg w-100\">\n          {{ invoice?.bill_to ? invoice?.bill_to.name : \"----\" }}\n          {{ invoice?.bill_to && \" - \" + (invoice?.bill_to.city | location) }}\n        </span>\n      </div>\n\n      <div class=\"col-12 d-flex flex-column align-items-start flex-md-row align-items-md-center mb-3\">\n        <button type=\"button\" class=\"flex-shrink-0 btn btn-primary mr-3 cust-btn\" (click)=\"data.onShipFrom()\">Ship From</button>\n        <span class=\"bg-grey-light flex-grow-1 h-100 p-2 rounded-lg w-100\">\n          {{ (invoice?.ship_from || invoice?.quick_ship_from)?.name || \"----\" }}\n          {{\n            (invoice?.ship_from || invoice?.quick_ship_from) && \" - \" + ((invoice?.ship_from || invoice?.quick_ship_from)?.city | location)\n          }}\n        </span>\n      </div>\n\n      <div class=\"col-12 d-flex flex-column align-items-start flex-md-row align-items-md-center mb-3\">\n        <button type=\"button\" class=\"flex-shrink-0 btn btn-primary mr-3 cust-btn\" (click)=\"data.onShipTo()\">Ship To</button>\n        <span class=\"bg-grey-light flex-grow-1 h-100 p-2 rounded-lg w-100\">\n          {{ (invoice?.ship_to || invoice?.quick_ship_to)?.name || \"----\" }}\n          {{ (invoice?.ship_to || invoice?.quick_ship_to) && \" - \" + ((invoice?.ship_to || invoice?.quick_ship_to)?.city | location) }}\n        </span>\n      </div>\n    </div>\n  </form>\n\n  <div class=\"w-100 mb-3 table-wrapper table-responsive custom-scroll\">\n    <table class=\"table table-sm mb-0 pb-5\">\n      <thead>\n        <tr>\n          <th scope=\"col\">Vehicle</th>\n          <th scope=\"col\">Vin</th>\n          <th scope=\"col\">Amount</th>\n          <th scope=\"col\"></th>\n        </tr>\n      </thead>\n      <tbody>\n        <tr *ngFor=\"let vehicle of invoice?.vehicles\">\n          <td>{{ vehicle.year }} {{ vehicle.make }} {{ vehicle.model }}</td>\n          <td>{{ vehicle.vin }}</td>\n          <td>{{ vehicle.amount | currency }}</td>\n          <td class=\"action-buttons\">\n            <button (click)=\"data.onEditVehicle(vehicle)\"><i class=\"fas fa-edit text-xl mr-3\"></i></button>\n            <button (click)=\"data.onDeleteVehicle(vehicle)\"><i class=\"fas fa-trash-alt text-xl\"></i></button>\n          </td>\n        </tr>\n      </tbody>\n    </table>\n    <div class=\"w-100 text-center\" *ngIf=\"!invoice?.vehicles?.length\">\n      <p class=\"border py-2\">No vehicles added</p>\n    </div>\n    <div class=\"flex-grow-1 bg-light add-vehicle-btn py-1\">\n      <button class=\"w-100 btn btn-outline-primary\" (click)=\"data.onAddVehicle()\">+ Add vehicle</button>\n    </div>\n  </div>\n\n  <div class=\"w-100 bg-grey-light p-4 rounded-lg\">\n    <div class=\"row\">\n      <span class=\"col-8 text-right\">Sub total:</span>\n      <span class=\"col-4 text-right\">${{ getSubTotal()?.toFixed(2) }}</span>\n    </div>\n    <div class=\"row\">\n      <span class=\"col-8 text-right\">Driver commission:</span>\n      <span class=\"col-4 text-right\">%{{ invoice?.driver?.commission || 0 }}</span>\n    </div>\n    <div class=\"row\">\n      <span class=\"col-8 text-right\">Driver commission amount:</span>\n      <span class=\"col-4 text-right\">${{ getDriverCommissionAmount()?.toFixed(2) }}</span>\n    </div>\n    <div class=\"row\">\n      <span class=\"col-8 text-right\">Total units:</span>\n      <span class=\"col-4 text-right\">{{ invoice?.vehicles?.length || 0 }}</span>\n    </div>\n    <div class=\"row\">\n      <span class=\"col-8 text-right\">Weight(kg):</span>\n      <span class=\"col-4 text-right\">{{ getWeight()?.toFixed(2) }}</span>\n    </div>\n    <div class=\"col-12 border border-secondary my-2\" style=\"opacity: 0.25\"></div>\n    <div class=\"row font-bold\">\n      <span class=\"col-8 text-right\">Total:</span>\n      <span class=\"col-4 text-right\">${{ getTotal()?.toFixed(2) }}</span>\n    </div>\n  </div>\n\n  <div class=\"d-flex w-100 px-0 px-md-4 pt-4 justify-content-between mt-2\">\n    <div class=\"col-5\">\n      <button class=\"btn w-100 btn-secondary\" (click)=\"onCancel()\">Cancel</button>\n    </div>\n    <div class=\"col-5\">\n      <button class=\"btn w-100 btn-success\" (click)=\"onSubmit()\">Save</button>\n    </div>\n  </div>\n</div>\n","import { Component, Inject, OnDestroy, OnInit } from \"@angular/core\";\nimport { MatDialogRef, MAT_DIALOG_DATA } from \"@angular/material/dialog\";\nimport { Subscription } from \"rxjs\";\nimport { Invoice, InvoiceBody, InvoiceStatus } from \"src/app/business/models/invoice.models\";\nimport { User } from \"src/app/business/models/user.models\";\nimport { Vehicle } from \"src/app/business/models/vehicle.models\";\nimport { CustomerService } from \"src/app/business/services/customer.service\";\nimport { InvoiceService } from \"src/app/business/services/invoice.service\";\nimport { RateService } from \"src/app/business/services/rate.service\";\nimport { UserService } from \"src/app/business/services/user.service\";\nimport { InvoicesStateService } from \"src/app/business/state/invoice-state.service\";\nimport { NotificationService } from \"src/app/shared/notifications/notification.service\";\n\nexport interface EditInvoiceDialogData {\n  onBillTo: (...args: any) => any;\n  onShipFrom: (...args: any) => any;\n  onShipTo: (...args: any) => any;\n  onAddVehicle: (...args: any) => any;\n  onEditVehicle: (vehicle: Vehicle) => any;\n  onDeleteVehicle: (vehicle: Vehicle) => any;\n  currentStep: 0 | 1;\n  setCurrentStep: (idx: 0 | 1) => any;\n}\n\ninterface Statuses {\n  value: InvoiceStatus;\n  label: string;\n}\n\nconst statuses: Statuses[] = [\n  { value: \"DRAFT\", label: \"Draft\" },\n  { value: \"SUBMITTED_FOR_REVIEW\", label: \"Submitted for review\" },\n  // { value: \"SUBMITTED_TO_CUSTOMER\", label: \"Submitted to customers\" },\n  // { value: \"PAID\", label: \"Paid\" },\n];\n\n@Component({\n  selector: \"app-edit-invoice-dialog\",\n  templateUrl: \"./edit-invoice-dialog.component.html\",\n  styleUrls: [\"./edit-invoice-dialog.component.scss\"],\n})\nexport class EditInvoiceDialogComponent implements OnInit, OnDestroy {\n  subscriptions: Subscription[] = [];\n  drivers: User[];\n  statuses: Statuses[] = statuses;\n  invoice: Partial<Invoice>;\n  isLoading = false;\n  viewMode: boolean;\n\n  constructor(\n    public dialogRef: MatDialogRef<EditInvoiceDialogComponent>,\n    @Inject(MAT_DIALOG_DATA) public data: EditInvoiceDialogData,\n    private userService: UserService,\n    public invoicesState: InvoicesStateService,\n    private rateService: RateService,\n    private notificationService: NotificationService,\n    private invoiceService: InvoiceService,\n    private customerService: CustomerService\n  ) {\n    const sub1 = this.userService.users.subscribe((data) => {\n      this.drivers = data;\n    });\n    const sub2 = this.invoicesState.selectedInvoice$.subscribe((invoice) => {\n      this.invoice = invoice;\n      this.viewMode = invoice.status !== \"DRAFT\" && invoice.status !== \"SUBMITTED_FOR_REVIEW\"\n    });\n    this.subscriptions.push(sub1, sub2);\n  }\n\n  ngOnInit() {\n    this.userService.fetchUsers();\n\n    const sub = this.customerService.getMostRecents().subscribe((data) => {\n      this.invoicesState.setMostRecentsCustomers(data);\n    });\n    this.subscriptions.push(sub);\n  }\n\n  onSelectDriver(event: any) {\n    this.invoicesState.setSelectedInvoice({ driver: this.drivers.find((d) => d.id === event.target.value) });\n  }\n\n  onSelectStatus(event: any) {\n    this.invoicesState.setSelectedInvoice({ status: event.target.value });\n  }\n\n  getSubTotal() {\n    let subtotal = 0;\n    this.invoice?.vehicles?.forEach((v) => {\n      subtotal += v.amount;\n    });\n    return subtotal;\n  }\n\n  getTotal() {\n    let total = 0;\n    this.invoice?.vehicles?.forEach((v) => {\n      total += v.amount;\n    });\n    return total;\n  }\n\n  getWeight() {\n    let weight = 0;\n    this.invoice?.vehicles?.forEach((v) => {\n      weight += Number(v.weight);\n    });\n    return weight;\n  }\n\n  getDriverCommissionAmount() {\n    const total = this.getSubTotal();\n    const driverCommission = this.invoice?.driver?.commission ?? 0;\n    const amount = total * (driverCommission / 100);\n    return amount;\n  }\n\n  onSubmit() {\n    if (\n      !this.invoice?.driver ||\n      !this.invoice?.status ||\n      !this.invoice?.bill_to ||\n      !(this.invoice?.ship_from ?? this.invoice?.quick_ship_from) ||\n      !(this.invoice?.ship_to ?? this.invoice?.quick_ship_to)\n    ) {\n      this.notificationService.error(\"Missed fields required\");\n      return;\n    }\n\n    if (!this.invoice?.vehicles?.length) {\n      this.notificationService.error(\"Missed vehicles required\");\n      return;\n    }\n\n    const body: InvoiceBody = {\n      bill_to: this.invoice.bill_to.id,\n      ship_from: this.invoice.ship_from?.id,\n      ship_to: this.invoice.ship_to?.id,\n      quick_ship_from: this.invoice.quick_ship_from,\n      quick_ship_to: this.invoice.quick_ship_to,\n      driver_id: this.invoice.driver.id,\n      status: this.invoice.status,\n      vehicles: this.invoice.vehicles?.map(({ _id, ...rest }) => rest),\n    };\n\n    this.isLoading = true;\n    this.invoiceService.updateInvoice(body, this.invoice.id).subscribe(\n      (res) => {\n        this.isLoading = false;\n        this.data.setCurrentStep(0);\n        this.notificationService.success(\"Invoice updated\");\n        this.dialogRef.close();\n      },\n      (err) => {\n        this.notificationService.error();\n        this.isLoading = false;\n      }\n    );\n  }\n\n  onCancel() {\n    this.invoicesState.resetSelectedInvoice();\n    this.data.setCurrentStep(0);\n    this.dialogRef.close();\n  }\n\n  parseStatus(status: InvoiceStatus) {\n    switch (status) {\n      case \"DRAFT\":\n        return \"Draft\";\n      case \"SUBMITTED_FOR_REVIEW\":\n        return \"Submitted for review\";\n      case \"SUBMITTED_TO_CUSTOMER\":\n        return \"Submitted to customer\";\n      case \"PAID\":\n        return \"Paid\";\n      default:\n        return \"Unknown\";\n    }\n  }\n\n  ngOnDestroy() {\n    this.subscriptions.forEach((sub) => sub.unsubscribe());\n  }\n}\n","<div class=\"dialog-content custom-scroll\">\n  <div *ngIf=\"isLoading\" class=\"dialog-loader\">\n    <mat-spinner [diameter]=\"50\"></mat-spinner>\n  </div>\n  <h3>{{ viewMode ? 'Invoice' : 'Edit Invoice' }}</h3>\n\n  <form class=\"form-group w-100 mt-3 new-invoice-form mb-2\">\n    <div class=\"col-12 d-flex justify-content-between mb-3 text-xl\">\n      <span> Invoice #: {{ invoice?.number }}</span>\n      <span>Date: {{ invoice?.date | date: \"MM/dd/yyyy\" }}</span>\n    </div>\n\n    <div class=\"col-12 mb-3\">\n      <label for=\"driver\" class=\"text-dark text-base\">Driver</label>\n      <div class=\"custom-select-wrapper\">\n        <select [disabled]=\"viewMode\" class=\"custom-select form-control\" (change)=\"onSelectDriver($event)\">\n          <option *ngIf=\"!invoice?.driver\" selected disabled value=\"\">Select driver...</option>\n          <option *ngFor=\"let driver of drivers\" [value]=\"driver.id\" [selected]=\"driver.id === invoice?.driver?.id\">\n            <span>{{ driver.first_name | titlecase }} {{ driver.last_name | titlecase }}</span> - {{ driver.email }}\n          </option>\n        </select>\n        <mat-icon class=\"half-arrow-icon\" svgIcon=\"half-arrow-down\"></mat-icon>\n      </div>\n    </div>\n\n    <div class=\"col-12 mb-3\">\n      <label for=\"status\" class=\"text-dark text-base\">Status</label>\n      <div class=\"custom-select-wrapper\">\n        <select [disabled]=\"viewMode\" class=\"custom-select form-control\" (change)=\"onSelectStatus($event)\">\n          <option *ngFor=\"let status of statuses\" [value]=\"status.value\" [selected]=\"invoice?.status && status.value === invoice?.status\">\n            {{ viewMode ? parseStatus(invoice.status) : status.label  }}\n          </option>\n        </select>\n        <mat-icon class=\"half-arrow-icon\" svgIcon=\"half-arrow-down\"></mat-icon>\n      </div>\n    </div>\n\n    <div class=\"mt-2 w-100\">\n      <div class=\"col-12 d-flex flex-column align-items-start flex-md-row align-items-md-center mb-3\">\n        <button [disabled]=\"viewMode\" type=\"button\" class=\"flex-shrink-0 btn btn-primary mr-3 cust-btn\" (click)=\"data.onBillTo()\">Bill To</button>\n        <span class=\"bg-grey-light flex-grow-1 h-100 p-2 rounded-lg w-100\">\n          {{ invoice?.bill_to ? invoice?.bill_to.name : \"----\" }}\n          {{ invoice?.bill_to && \" - \" + (invoice?.bill_to.city | location) }}\n        </span>\n      </div>\n\n      <div class=\"col-12 d-flex flex-column align-items-start flex-md-row align-items-md-center mb-3\">\n        <button [disabled]=\"viewMode\" type=\"button\" class=\"flex-shrink-0 btn btn-primary mr-3 cust-btn\" (click)=\"data.onShipFrom()\">Ship From</button>\n        <span class=\"bg-grey-light flex-grow-1 h-100 p-2 rounded-lg w-100\">\n          {{ (invoice?.ship_from || invoice?.quick_ship_from)?.name || \"----\" }}\n          {{\n            (invoice?.ship_from || invoice?.quick_ship_from) && \" - \" + ((invoice?.ship_from || invoice?.quick_ship_from)?.city | location)\n          }}\n        </span>\n      </div>\n\n      <div class=\"col-12 d-flex flex-column align-items-start flex-md-row align-items-md-center\">\n        <button [disabled]=\"viewMode\" type=\"button\" class=\"flex-shrink-0 btn btn-primary mr-3 cust-btn\" (click)=\"data.onShipTo()\">Ship To</button>\n        <span class=\"bg-grey-light flex-grow-1 h-100 p-2 rounded-lg w-100\">\n          {{ (invoice?.ship_to || invoice?.quick_ship_to)?.name || \"----\" }}\n          {{ (invoice?.ship_to || invoice?.quick_ship_to) && \" - \" + ((invoice?.ship_to || invoice?.quick_ship_to)?.city | location) }}\n        </span>\n      </div>\n    </div>\n  </form>\n\n  <div class=\"w-100 mb-3 table-wrapper table-responsive custom-scroll\">\n    <table class=\"table table-sm mb-0 pb-5\">\n      <thead>\n        <tr>\n          <th scope=\"col\">Vehicle</th>\n          <th scope=\"col\">Vin</th>\n          <th scope=\"col\">Amount</th>\n          <th scope=\"col\">Actions</th>\n        </tr>\n      </thead>\n      <tbody>\n        <tr *ngFor=\"let vehicle of invoice?.vehicles\">\n          <td>{{ vehicle.year }} {{ vehicle.make }} {{ vehicle.model }}</td>\n          <td>{{ vehicle.vin }}</td>\n          <td>{{ vehicle.amount | currency }}</td>\n          <td *ngIf=\"!viewMode\" class=\"action-buttons\">\n            <button (click)=\"data.onEditVehicle(vehicle)\"><i class=\"fas fa-edit text-xl mr-3\"></i></button>\n            <button (click)=\"data.onDeleteVehicle(vehicle)\"><i class=\"fas fa-trash-alt text-xl\"></i></button>\n          </td>\n          <td *ngIf=\"viewMode\" class=\"action-buttons justify-content-center\">\n            <button (click)=\"data.onEditVehicle(vehicle)\"><i class=\"fas fa-eye text-xl mr-3\"></i></button>\n          </td>\n        </tr>\n      </tbody>\n    </table>\n    <div class=\"w-100 text-center\" *ngIf=\"!invoice?.vehicles?.length\">\n      <p class=\"border py-2\">No vehicles added</p>\n    </div>\n    <div *ngIf=\"!viewMode\" class=\"flex-grow-1 bg-light add-vehicle-btn py-1\">\n      <button class=\"w-100 btn btn-outline-primary\" (click)=\"data.onAddVehicle()\">+ Add vehicle</button>\n    </div>\n  </div>\n\n  <div class=\"w-100 bg-grey-light p-4 rounded-lg\">\n    <div class=\"row\">\n      <span class=\"col-8 text-right\">Sub total:</span>\n      <span class=\"col-4 text-right\">${{ getSubTotal()?.toFixed(2) }}</span>\n    </div>\n    <div class=\"row\">\n      <span class=\"col-8 text-right\">Driver commission:</span>\n      <span class=\"col-4 text-right\">%{{ invoice?.driver?.commission || 0 }}</span>\n    </div>\n    <div class=\"row\">\n      <span class=\"col-8 text-right\">Driver commission amount:</span>\n      <span class=\"col-4 text-right\">${{ getDriverCommissionAmount()?.toFixed(2) }}</span>\n    </div>\n    <div class=\"row\">\n      <span class=\"col-8 text-right\">Total units:</span>\n      <span class=\"col-4 text-right\">{{ invoice?.vehicles?.length || 0 }}</span>\n    </div>\n    <div class=\"row\">\n      <span class=\"col-8 text-right\">Weight(kg):</span>\n      <span class=\"col-4 text-right\">{{ getWeight()?.toFixed(2) }}</span>\n    </div>\n    <div class=\"col-12 border border-secondary my-2\" style=\"opacity: 0.25\"></div>\n    <div class=\"row font-bold\">\n      <span class=\"col-8 text-right\">Total:</span>\n      <span class=\"col-4 text-right\">${{ getTotal()?.toFixed(2) }}</span>\n    </div>\n  </div>\n\n  <div *ngIf=\"!viewMode\" class=\"d-flex w-100 px-0 px-md-4 pt-4 justify-content-between my-2\">\n    <div class=\"col-5\">\n      <button class=\"btn w-100 btn-secondary\" type=\"button\" (click)=\"onCancel()\">Cancel</button>\n    </div>\n    <div class=\"col-5\">\n      <button class=\"btn w-100 btn-success\" (click)=\"onSubmit()\">Save</button>\n    </div>\n  </div>\n\n  <div *ngIf=\"viewMode\" class=\"d-flex w-100 px-0 px-md-4 pt-4 justify-content-center my-2\">\n    <div class=\"col-5\">\n      <button class=\"btn w-100 btn-secondary\" type=\"button\" (click)=\"onCancel()\">Back</button>\n    </div>\n  </div>\n</div>\n","import { HttpClient } from '@angular/common/http'\nimport { Injectable } from '@angular/core'\nimport { map } from 'rxjs/operators'\nimport { environment } from 'src/environments/environment'\nimport { PaginatedResponse } from '../models/api.models'\nimport { Invoice, InvoiceBody, InvoicePaginatedResponse, InvoiceStatus } from '../models/invoice.models'\nimport { InvoicesStateService } from '../state/invoice-state.service'\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class InvoiceService {\n  private baseUrl = environment.apiUrl\n\n  constructor(private http: HttpClient, private invoicesState: InvoicesStateService) {}\n\n  fetchInvoices(status?: InvoiceStatus, limit: number = 0, page: number = 0): Promise<InvoicePaginatedResponse> {\n    return new Promise((resolve, reject) => {\n      let url = `${this.baseUrl}/invoices/admin?limit=${limit}&page=${page}`\n      if (status) {\n        url += `&status=${status}`\n      } else {\n        url += `&status=DRAFT&status=SUBMITTED_FOR_REVIEW&status=SUBMITTED_TO_CUSTOMER`\n      }\n      this.http.get<PaginatedResponse<Invoice>>(url).subscribe(\n        (data) => {\n          this.invoicesState.setInvoices(data.results)\n          resolve(data)\n        },\n        (err) => {\n          reject(err)\n        }\n      )\n    })\n  }\n\n  saveInvoice(body: InvoiceBody) {\n    return this.http.post<Invoice>(`${this.baseUrl}/invoices/admin`, body).pipe(\n      map((res) => {\n        this.fetchInvoices()\n        return res\n      })\n    )\n  }\n\n  updateInvoice(body: InvoiceBody, invoiceId: string) {\n    return this.http.put<Invoice>(`${this.baseUrl}/invoices/admin/${invoiceId}`, body).pipe(\n      map((res) => {\n        this.fetchInvoices()\n        return res\n      })\n    )\n  }\n\n  deleteInvoice(id: string) {\n    return this.http.delete<Invoice>(`${this.baseUrl}/invoices/admin/${id}`).pipe(\n      map((res) => {\n        this.fetchInvoices()\n        return res\n      })\n    )\n  }\n\n  submitDraftInvoices(invoiceIds: string[]) {\n    return this.http.post<Invoice>(`${this.baseUrl}/invoices/admin/submitToReview`, { invoices: invoiceIds }).pipe(\n      map((res) => {\n        this.fetchInvoices()\n        return res\n      })\n    )\n  }\n\n  submitInvoicesToQB(invoiceIds: string[]) {\n    return this.http.post<Invoice>(`${this.baseUrl}/invoices/admin/submitToQB`, { invoices: invoiceIds }).pipe(\n      map((res) => {\n        this.fetchInvoices()\n        return res\n      })\n    )\n  }\n\n  submitInvoicesToPaid(invoiceIds: string[]) {\n    return this.http.post<Invoice>(`${this.baseUrl}/invoices/admin/submitToPaid`, { invoices: invoiceIds }).pipe(\n      map((res) => {\n        this.fetchInvoices()\n        return res\n      })\n    )\n  }\n\n  exportToPdf(invoices: Invoice[]) {\n    return new Promise((resolve, reject) => {\n      this.http\n        .post(\n          `${this.baseUrl}/invoices/exportToPdf`,\n          { invoices: invoices.map((inv) => inv.id) },\n          {\n            responseType: 'arraybuffer',\n          }\n        )\n        .subscribe(\n          (data: any) => {\n            const blob = new Blob([data], { type: 'application/zip' })\n            const url = window.URL.createObjectURL(blob)\n            //window.open(url);\n            const link = document.createElement('a')\n            link.href = url\n            link.setAttribute('download', 'invoices.zip')\n            document.body.appendChild(link)\n            link.click()\n            resolve(true)\n          },\n          (err) => reject(false)\n        )\n    })\n  }\n}\n","import { NgModule } from \"@angular/core\";\nimport { CommonModule } from \"@angular/common\";\nimport { InvoiceComponent } from \"./invoice.component\";\nimport { RouterModule } from \"@angular/router\";\nimport { SharedModule } from \"../shared/shared.module\";\nimport { NewInvoiceDialogComponent } from \"./new-invoice-dialog/new-invoice-dialog.component\";\nimport { BillToDialogComponent } from \"./bill-to-dialog/bill-to-dialog.component\";\nimport { ShipSelectDialogComponent } from \"./ship-select-dialog/ship-select-dialog.component\";\nimport { MatExpansionModule } from \"@angular/material/expansion\";\nimport { AddVehicleDialogComponent } from \"./add-vehicle-dialog/add-vehicle-dialog.component\";\nimport { EditInvoiceDialogComponent } from \"./edit-invoice-dialog/edit-invoice-dialog.component\";\nimport { EditVehicleDialogComponent } from \"./edit-vehicle-dialog/edit-vehicle-dialog.component\";\n\nexport const routes = [\n  {\n    path: \"\",\n    component: InvoiceComponent,\n  },\n];\n\n@NgModule({\n  declarations: [\n    InvoiceComponent,\n    NewInvoiceDialogComponent,\n    BillToDialogComponent,\n    ShipSelectDialogComponent,\n    AddVehicleDialogComponent,\n    EditVehicleDialogComponent,\n    EditInvoiceDialogComponent,\n  ],\n  imports: [CommonModule, RouterModule.forChild(routes), SharedModule, MatExpansionModule],\n})\nexport class InvoiceModule {}","import { Component, Inject, OnDestroy, OnInit } from \"@angular/core\";\nimport { FormBuilder, FormGroup, Validators } from \"@angular/forms\";\nimport { MatDialogRef, MAT_DIALOG_DATA } from \"@angular/material/dialog\";\nimport { Subscription } from \"rxjs\";\nimport { Customer, QuickEntryCustomer } from \"src/app/business/models/customer.models\";\nimport { City, CurrentCities, State } from \"src/app/business/models/geo.models\";\nimport { Invoice } from \"src/app/business/models/invoice.models\";\nimport { CustomerService } from \"src/app/business/services/customer.service\";\nimport { GeoService } from \"src/app/business/services/geo.service\";\nimport { InvoicesStateService } from \"src/app/business/state/invoice-state.service\";\nimport { regexs } from \"src/app/core/config/constants\";\n\nexport interface ShipSelectDialogData {\n  onBackToInvoice: (...args: any) => any;\n  //onCustomerQuickEntry: (...args: any) => any;\n  type: \"FROM\" | \"TO\";\n  action: \"new\" | \"edit\";\n}\n\n@Component({\n  selector: \"app-ship-select-dialog\",\n  templateUrl: \"./ship-select-dialog.component.html\",\n  styleUrls: [\"./ship-select-dialog.component.scss\"],\n})\nexport class ShipSelectDialogComponent implements OnInit, OnDestroy {\n  subscriptions: Subscription[] = [];\n  foundCustomers: Customer[] = [];\n  customerForm: FormGroup;\n  showQuickEntry = false;\n  states: State[] = [];\n  selectedState: string;\n  cities: CurrentCities = {};\n  selectedInvoice: Invoice;\n  currentCity;\n  mostRecentsCustomers: Customer[] = [];\n\n  constructor(\n    public dialogRef: MatDialogRef<ShipSelectDialogComponent>,\n    @Inject(MAT_DIALOG_DATA) public data: ShipSelectDialogData,\n    private fb: FormBuilder,\n    private invoicesState: InvoicesStateService,\n    private customerService: CustomerService,\n    private geoService: GeoService\n  ) {}\n\n  ngOnInit() {\n    this.buildForm();\n    this.states = this.geoService.states;\n    const sub = this.geoService.currentCities.subscribe((data) => {\n      this.cities = data;\n\n      if (this.currentCity) {\n        this.customerForm.controls.city_id.reset();\n        this.customerForm.controls.city_id.setValue(this.cities[this.selectedState]?.find((c) => c.name === this.currentCity.name)?.id);\n      }\n    });\n    this.subscriptions.push(sub);\n\n    //when invoice creating\n    if (this.data.action === \"new\") {\n      const sub2 = this.invoicesState.newInvoice$.subscribe((data) => this.handleEditQuickEntry(data));\n      this.subscriptions.push(sub2);\n    }\n\n    //when invoice updating\n    if (this.data.action === \"edit\") {\n      const sub2 = this.invoicesState.selectedInvoice$.subscribe((data) => this.handleEditQuickEntry(data));\n      this.subscriptions.push(sub2);\n    }\n\n    const sub3 = this.invoicesState.mostRecentsCustomers$.subscribe((data) => {\n      this.mostRecentsCustomers = data;\n    });\n    this.subscriptions.push(sub3);\n  }\n\n  handleEditQuickEntry(data) {\n    if (!data) return;\n    this.selectedInvoice = data as Invoice;\n\n    if (\n      (this.data.type === \"FROM\" && this.selectedInvoice?.quick_ship_from) ||\n      (this.data.type === \"TO\" && this.selectedInvoice?.quick_ship_to)\n    ) {\n      if (this.data.type === \"FROM\") {\n        this.currentCity = this.selectedInvoice?.quick_ship_from?.city;\n        this.selectedState = this.selectedInvoice?.quick_ship_from?.city.state_code;\n        this.customerForm.controls.name.setValue(this.selectedInvoice?.quick_ship_from?.name);\n      } else {\n        this.currentCity = this.selectedInvoice?.quick_ship_to?.city;\n        this.selectedState = this.selectedInvoice?.quick_ship_to?.city.state_code;\n        this.customerForm.controls.name.setValue(this.selectedInvoice?.quick_ship_to?.name);\n      }\n\n      this.geoService.fetchCitiesByState(this.selectedState);\n      this.customerForm.controls.city_id.reset();\n      this.customerForm.controls.city_id.setValue(this.cities[this.selectedState]?.find((c) => c.name === this.currentCity.name)?.id);\n      this.showQuickEntry = true;\n    }\n  }\n\n  private buildForm() {\n    this.customerForm = this.fb.group({\n      name: [\"\", [Validators.required]],\n      city_id: [\"\", [Validators.required]],\n    });\n  }\n\n  backToInvoice() {\n    this.data.onBackToInvoice();\n  }\n\n  async searchCustomers(e: any) {\n    const query = e.target.value;\n    this.foundCustomers = await this.customerService.searchCustomers(query);\n  }\n\n  onSelect(customer: Customer | QuickEntryCustomer, isQuickEntry = false) {\n    const setInvoice =\n      this.data.action === \"new\" ? (data) => this.invoicesState.setNewInvoice(data) : (data) => this.invoicesState.setSelectedInvoice(data);\n    const isFrom = this.data.type === \"FROM\";\n    if (isQuickEntry) {\n      setInvoice({\n        [isFrom ? \"quick_ship_from\" : \"quick_ship_to\"]: customer,\n        [isFrom ? \"ship_from\" : \"ship_to\"]: null,\n      });\n    } else {\n      setInvoice({\n        [isFrom ? \"ship_from\" : \"ship_to\"]: customer,\n        [isFrom ? \"quick_ship_from\" : \"quick_ship_to\"]: null,\n      });\n    }\n    this.data.onBackToInvoice();\n  }\n\n  onQuickEntry(event: any) {\n    event.target.blur();\n    this.customerForm.reset();\n    this.showQuickEntry = !this.showQuickEntry;\n  }\n\n  onStateChange(event: any) {\n    this.selectedState = event.target.value;\n    this.geoService.fetchCitiesByState(this.selectedState);\n    this.customerForm.controls.city_id.reset();\n  }\n\n  saveQuickEntry() {\n    if (this.customerForm.invalid) {\n      return Object.values(this.customerForm.controls).forEach((control) => {\n        if (control instanceof FormGroup) {\n          Object.values(control.controls).forEach((control) => control.markAsTouched());\n        } else {\n          control.markAsTouched();\n        }\n      });\n    } else {\n      //save customer\n      const selectedCity: City = this.cities[this.selectedState]?.find((c) => c.id === this.customerForm.controls.city_id.value);\n      const body = {\n        name: this.customerForm.controls.name.value,\n        city: {\n          name: selectedCity?.name,\n          state: selectedCity?.state_name,\n          state_code: selectedCity?.state_code,\n        },\n      };\n\n      this.onSelect(body, true);\n    }\n  }\n\n  ngOnDestroy() {\n    this.subscriptions.forEach((sub) => sub.unsubscribe());\n  }\n}\n","<h3>{{ data.type === \"TO\" ? \"Ship to\" : \"Ship from\" }}</h3>\n\n<div class=\"input-group pt-3\">\n  <div class=\"input-group-prepend\">\n    <span class=\"input-group-text\">\n      <i class=\"fas fa-search\"></i>\n    </span>\n  </div>\n  <input type=\"text\" class=\"form-control\" placeholder=\"Search customer...\" (input)=\"searchCustomers($event)\" />\n  <div class=\"w-100 text-secondary text-sm\">Min 3 characters</div>\n</div>\n\n<div class=\"w-100 my-3 table-wrapper table-responsive custom-scroll\">\n  <table class=\"table table-sm table-bordered\">\n    <thead>\n      <tr>\n        <th scope=\"col\">Customer list</th>\n      </tr>\n    </thead>\n    <tbody>\n      <div class=\"w-100 text-center\" *ngIf=\"!foundCustomers?.length\">\n        <p class=\"border py-2\">No customers found</p>\n      </div>\n      <tr *ngFor=\"let customer of foundCustomers\" (click)=\"onSelect(customer)\">\n        <td>{{ customer.name }}</td>\n      </tr>\n    </tbody>\n  </table>\n\n  <div class=\"flex-grow-1 bg-light quick-entry-btn py-1\">\n    <button class=\"w-100 btn btn-outline-primary\" (click)=\"onQuickEntry($event)\">+ Quick entry</button>\n  </div>\n</div>\n\n<!-- quick entry panel -->\n<form *ngIf=\"showQuickEntry\" class=\"py-2 mt-n4 mb-3 border-primary-1\" [formGroup]=\"customerForm\" (ngSubmit)=\"saveQuickEntry()\">\n  <div class=\"col-12 mb-3\">\n    <label for=\"name\" class=\"text-dark text-base\">Name</label>\n    <input\n      id=\"name\"\n      name=\"name\"\n      type=\"text\"\n      class=\"form-control\"\n      formControlName=\"name\"\n      [class.is-invalid]=\"customerForm.controls.name.touched && customerForm.controls.name.invalid\"\n    />\n    <div class=\"form-text invalid-feedback\" *ngIf=\"true\">Invalid field</div>\n  </div>\n\n  <div class=\"col-12 mb-3\">\n    <label for=\"state\" class=\"text-dark text-base\">State</label>\n    <div class=\"custom-select-wrapper\">\n      <select class=\"custom-select form-control\" (change)=\"onStateChange($event)\">\n        <option selected value=\"\">Select state...</option>\n        <option *ngFor=\"let state of states\" [value]=\"state.code\" [selected]=\"state.code === currentCity?.state_code\">\n          {{ state.name }}\n        </option>\n      </select>\n      <mat-icon class=\"half-arrow-icon\" svgIcon=\"half-arrow-down\"></mat-icon>\n    </div>\n  </div>\n\n  <div class=\"col-12 mb-3\">\n    <label for=\"city_id\" class=\"text-dark text-base\">City</label>\n    <div class=\"custom-select-wrapper\">\n      <select\n        class=\"custom-select form-control\"\n        formControlName=\"city_id\"\n        [class.is-invalid]=\"customerForm.controls.city_id.touched && customerForm.controls.city_id.invalid\"\n      >\n        <option *ngFor=\"let city of cities[selectedState]\" [value]=\"city.id\" [selected]=\"city.name === currentCity?.name\">\n          {{ city.name }}\n        </option>\n      </select>\n      <mat-icon class=\"half-arrow-icon\" svgIcon=\"half-arrow-down\"></mat-icon>\n    </div>\n  </div>\n\n  <div class=\"col-12\">\n    <button class=\"btn w-100 btn-success\" type=\"submit\">Save</button>\n  </div>\n</form>\n\n<div class=\"w-100 my-3 table-wrapper table-responsive custom-scroll\">\n  <table class=\"table table-sm table-bordered\">\n    <thead>\n      <tr>\n        <th scope=\"col\">Most recent</th>\n      </tr>\n    </thead>\n    <tbody>\n      <!-- <div class=\"w-100 text-center\">\n        <p class=\"border py-2\">No customers found</p>\n      </div> -->\n      <div class=\"w-100 text-center\" *ngIf=\"!mostRecentsCustomers?.length\">\n        <p class=\"border py-2\">No customers found</p>\n      </div>\n      <tr *ngFor=\"let customer of mostRecentsCustomers\" (click)=\"onSelect(customer)\">\n        <td>{{ customer.name }}</td>\n      </tr>\n    </tbody>\n  </table>\n</div>\n\n<div class=\"w-100 mt-3\">\n  <button class=\"w-100 btn btn-outline-primary\" (click)=\"backToInvoice()\">Back to invoice</button>\n</div>\n"],"sourceRoot":"webpack:///"}