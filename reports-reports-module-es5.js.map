{"version":3,"sources":["webpack:///src/app/shared/notifications/notification.service.ts","webpack:///src/app/business/services/user.service.ts","webpack:///src/app/reports/reports.component.ts","webpack:///src/app/reports/reports.component.html","webpack:///src/app/reports/reports.module.ts"],"names":["NotificationService","snackBar","msg","showNotification","type","icon","mySnackBarRef","openFromComponent","data","message","dismissible","duration","horizontalPosition","verticalPosition","panelClass","instance","snackBarRef","providedIn","UserService","http","baseUrl","apiUrl","users","Promise","resolve","reject","get","subscribe","next","err","body","post","pipe","res","fetchUsers","id","isAdmin","url","put","ReportsComponent","userService","companyService","notificationService","subscriptions","displayedColumns","pageSizeOptions","dateRange","dates","loading","items","sub","push","setDates","sinceDay","Date","i","selectedDate","event","selectedDriver","find","user","target","value","getReport","dateFrom","toISOString","dateTo","report","invoices","error","getReportPdf","sort","paginator","forEach","unsubscribe","onDateRangeSelect","onSelectDate","onSelectDriver","selector","templateUrl","styleUrls","routes","path","component","ReportsModule","forChild","declarations","imports"],"mappings":"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","file":"reports-reports-module-es5.js","sourcesContent":["import { Injectable } from \"@angular/core\";\nimport { MatSnackBar } from \"@angular/material/snack-bar\";\nimport { NotificationTemplateComponent } from \"../notification-template/notification-template.component\";\n\n@Injectable({\n  providedIn: \"root\",\n})\nexport class NotificationService {\n  mySnackBarRef: any;\n\n  constructor(public snackBar: MatSnackBar) {}\n\n  success(msg: string = \"Action successfully\") {\n    this.showNotification(msg, \"success\", \"check-circle\");\n  }\n\n  error(msg: string = \"Action failed\") {\n    this.showNotification(msg, \"danger\", \"exclamation-triangle\");\n  }\n\n  info(msg: string) {\n    this.showNotification(msg, \"info\", \"info\");\n  }\n\n  warning(msg: string) {\n    this.showNotification(msg, \"warning\", \"info\");\n  }\n\n  private showNotification(msg = \"Missed message\", type: \"danger\" | \"info\" | \"success\" | \"warning\", icon: string): void {\n    // for more info about Angular Material snackBar check: https://material.angular.io/components/snack-bar/overview\n    this.mySnackBarRef = this.snackBar.openFromComponent(NotificationTemplateComponent, {\n      data: {\n        message: msg,\n        icon,\n        type,\n        dismissible: true,\n        // you can add everything you want here\n      },\n      duration: type !== \"success\" ? 6000 : 3000,\n      horizontalPosition: \"right\", // 'start' | 'center' | 'end' | 'left' | 'right'\n      verticalPosition: \"bottom\", // 'top' | 'bottom'\n      panelClass: [\"notification-wrapper\"],\n    });\n    // this is to be able to close it from the NotificationComponent\n    this.mySnackBarRef.instance.snackBarRef = this.mySnackBarRef;\n  }\n}\n","import { HttpClient } from '@angular/common/http'\nimport { Injectable } from '@angular/core'\nimport { BehaviorSubject } from 'rxjs'\nimport { map } from 'rxjs/operators'\nimport { environment } from 'src/environments/environment'\nimport { User, UserBody } from '../models/user.models'\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class UserService {\n  private baseUrl = environment.apiUrl\n\n  public users: BehaviorSubject<User[]> = new BehaviorSubject(null)\n\n  constructor(private http: HttpClient) {}\n\n  fetchUsers() {\n    return new Promise((resolve, reject) => {\n      this.http.get<User[]>(`${this.baseUrl}/users/admin`).subscribe(\n        (data) => {\n          this.users.next(data)\n          resolve(data)\n        },\n        (err) => {\n          reject(err)\n        }\n      )\n    })\n  }\n\n  getUserAuth() {\n    return this.http.get<User>(`${this.baseUrl}/users/me`)\n  }\n\n  saveUser(body: UserBody) {\n    return this.http.post<User>(`${this.baseUrl}/users/admin`, body).pipe(\n      map((res) => {\n        this.fetchUsers()\n        return res\n      })\n    )\n  }\n\n  updateUser(body: UserBody, id: string, isAdmin: boolean = true) {\n    const url = isAdmin ? `${this.baseUrl}/users/admin/${id}` : `${this.baseUrl}/users/me`\n    return this.http.put<User>(url, body).pipe(\n      map((res) => {\n        this.fetchUsers()\n        return res\n      })\n    )\n  }\n\n  deleteUser(id: string) {\n    return this.http.delete<User>(`${this.baseUrl}/users/admin/${id}`).pipe(\n      map((res) => {\n        this.fetchUsers()\n        return res\n      })\n    )\n  }\n\n  changePassword(body: { current_password: string; new_password: string }) {\n    return this.http.post(`${this.baseUrl}/users/me/changePassword`, body)\n  }\n}\n","import { AfterViewInit, Component, OnDestroy, OnInit, ViewChild } from \"@angular/core\";\nimport { MatPaginator } from \"@angular/material/paginator\";\nimport { MatSort } from \"@angular/material/sort\";\nimport { MatTableDataSource } from \"@angular/material/table\";\nimport { addMonths, addWeeks, previousMonday, startOfMonth } from \"date-fns\";\nimport { Subscription } from \"rxjs\";\nimport { Report } from \"../business/models/company.models\";\nimport { ReportInvoice } from \"../business/models/invoice.models\";\nimport { User } from \"../business/models/user.models\";\nimport { CompanyService } from \"../business/services/company.service\";\nimport { UserService } from \"../business/services/user.service\";\nimport { NotificationService } from \"../shared/notifications/notification.service\";\n\n@Component({\n  selector: \"app-reports\",\n  templateUrl: \"./reports.component.html\",\n  styleUrls: [\"./reports.component.scss\"],\n})\nexport class ReportsComponent implements OnInit, AfterViewInit, OnDestroy {\n  @ViewChild(MatSort) sort: MatSort;\n  @ViewChild(MatPaginator) paginator: MatPaginator;\n\n  subscriptions: Subscription[] = [];\n  displayedColumns = [\"date\", \"invoice\", \"ship_from\", \"ship_to\", \"amount\"];\n  pageSizeOptions: number[] = [12, 24, 50, 100];\n  items: MatTableDataSource<ReportInvoice>;\n  users: User[];\n  selectedDriver: User;\n  dateRange: \"week\" | \"month\" = \"week\";\n  dates: Date[] = [];\n  selectedDate: Date;\n  report: Report;\n  loading = false;\n\n  constructor(private userService: UserService, private companyService: CompanyService, private notificationService: NotificationService) {\n    this.items = new MatTableDataSource([]);\n    const sub = this.userService.users.subscribe((data) => {\n      this.users = data;\n    });\n    this.subscriptions.push(sub);\n  }\n\n  ngOnInit() {\n    this.userService.fetchUsers();\n    this.setDates();\n  }\n\n  setDates() {\n    this.dates = [];\n    let sinceDay;\n    if (this.dateRange === \"week\") {\n      sinceDay = previousMonday(new Date());\n      for (let i = 0; i < 30; i++) {\n        this.dates.push(addWeeks(sinceDay, -i));\n      }\n    } else {\n      sinceDay = startOfMonth(new Date());\n      for (let i = 0; i < 24; i++) {\n        this.dates.push(addMonths(sinceDay, -i));\n      }\n    }\n    this.selectedDate = null;\n  }\n\n  onSelectDriver(event: any) {\n    this.selectedDriver = this.users.find((user) => user.id === event.target.value);\n    this.getReport();\n  }\n\n  onSelectDate(event: any) {\n    this.selectedDate = new Date(event.target.value);\n    this.getReport();\n  }\n\n  onDateRangeSelect(event: any) {\n    this.dateRange = event.target.value;\n    this.setDates();\n  }\n\n  getReport() {\n    if (!this.selectedDriver || !this.selectedDate) return;\n    const dateFrom = this.selectedDate.toISOString();\n    const dateTo = this.dateRange === \"week\" ? addWeeks(this.selectedDate, 1).toISOString() : addMonths(this.selectedDate, 1).toISOString();\n    this.loading = true;\n    this.companyService.getReport(this.selectedDriver.id, dateFrom, dateTo).subscribe(\n      (data) => {\n        this.report = data as Report;\n        this.items.data = data.invoices;\n        this.loading = false;\n      },\n      (err) => {\n        this.loading = false;\n        this.notificationService.error(\"Unexpected error\");\n      }\n    );\n  }\n\n  getReportPdf() {\n    if (!this.selectedDriver || !this.selectedDate) return;\n    const dateFrom = this.selectedDate.toISOString();\n    const dateTo = this.dateRange === \"week\" ? addWeeks(this.selectedDate, 1).toISOString() : addMonths(this.selectedDate, 1).toISOString();\n    this.companyService.getReportPdf(this.selectedDriver, dateFrom, dateTo)\n  }\n\n  ngAfterViewInit() {\n    this.items.sort = this.sort;\n    this.items.paginator = this.paginator;\n  }\n\n  ngOnDestroy() {\n    this.subscriptions.forEach((sub) => sub.unsubscribe());\n  }\n}\n","<div class=\"px-2 px-md-5 py-3 position-relative\">\n  <div *ngIf=\"loading\" class=\"loader\">\n    <mat-spinner [diameter]=\"50\"></mat-spinner>\n  </div>\n  <!-- HEADER -->\n  <div class=\"d-flex flex-wrap justify-content-between col-12 align-items-end mb-4\">\n    <div>\n      <h1 class=\"text-dark content-title\">Reports</h1>\n      <span class=\"content-sub-title w-100 d-block mb-2\" *ngIf=\"!!report\"\n        >Data from <b>{{ report?.formatDateFrom | date: \"MM/dd/yyyy\" }}</b> to <b>{{ report?.formatDateTo | date: \"MM/dd/yyyy\" }}</b></span\n      >\n    </div>\n    <div class=\"flex-grow-1 d-flex flex-wrap justify-content-between\">\n      <div class=\"d-none d-md-block flex-grow-1\"></div>\n      <div class=\"col-5 col-sm-3 col-md-2 px-0 pr-md-1 mt-2 mt-md-0\">\n        <div class=\"custom-select-wrapper\">\n          <select class=\"custom-select form-control\" (change)=\"onDateRangeSelect($event)\">\n            <option value=\"week\">Weekly</option>\n            <option value=\"month\">Monthly</option>\n          </select>\n          <mat-icon class=\"half-arrow-icon\" svgIcon=\"half-arrow-down\"></mat-icon>\n        </div>\n      </div>\n\n      <div class=\"col-6 col-sm-5 col-md-4 px-0 px-md-1 mt-2 mt-md-0\">\n        <div class=\"custom-select-wrapper\">\n          <select class=\"custom-select form-control\" (change)=\"onSelectDate($event)\">\n            <option *ngIf=\"!selectedDate\" selected disabled value=\"\">Select date...</option>\n            <option *ngFor=\"let date of dates\" [value]=\"date\">\n              {{ date | date: \"MM/dd/yyyy\" }}\n            </option>\n          </select>\n          <mat-icon class=\"half-arrow-icon\" svgIcon=\"half-arrow-down\"></mat-icon>\n        </div>\n      </div>\n\n      <div class=\"col-9 col-sm-6 col-md-4 px-0 px-md-1 mt-2 mt-md-0\">\n        <div class=\"custom-select-wrapper\">\n          <select class=\"custom-select form-control\" (change)=\"onSelectDriver($event)\">\n            <option *ngIf=\"!selectedDriver\" selected disabled value=\"\">Select driver...</option>\n            <option *ngFor=\"let driver of users\" [value]=\"driver.id\">\n              <span>{{ driver.first_name | titlecase }} {{ driver.last_name | titlecase }}</span>\n            </option>\n          </select>\n          <mat-icon class=\"half-arrow-icon\" svgIcon=\"half-arrow-down\"></mat-icon>\n        </div>\n      </div>\n\n      <button class=\"btn btn-primary mt-2 mt-md-0\" (click)=\"getReportPdf()\" [disabled]=\"!items.data.length\">PDF</button>\n    </div>\n  </div>\n\n  <!-- TABLE -->\n  <div class=\"row\">\n    <div class=\"col-12 table-wrapper table-responsive\">\n      <table mat-table [dataSource]=\"items\" class=\"table table-borderless table-striped\" matSort>\n        <ng-container matColumnDef=\"date\">\n          <th mat-header-cell *matHeaderCellDef>Date</th>\n          <td mat-cell *matCellDef=\"let item\">{{ item.date | date: \"MM/dd/yyyy\" }}</td>\n        </ng-container>\n\n        <ng-container matColumnDef=\"invoice\">\n          <th mat-header-cell *matHeaderCellDef>Invoice</th>\n          <td mat-cell *matCellDef=\"let item\">{{ item.number }}</td>\n        </ng-container>\n\n        <ng-container matColumnDef=\"ship_from\">\n          <th mat-header-cell *matHeaderCellDef>Ship from</th>\n          <td mat-cell *matCellDef=\"let item\">\n            {{ item.ship_from?.name || item.quick_ship_from?.name }} <br />\n            {{ item.ship_from?.city?.name || item.quick_ship_from?.city?.name }},\n            {{ item.ship_from?.city?.state_code || item.quick_ship_from?.city?.state_code }}\n          </td>\n        </ng-container>\n\n        <ng-container matColumnDef=\"ship_to\">\n          <th mat-header-cell *matHeaderCellDef>Ship to</th>\n          <td mat-cell *matCellDef=\"let item\">\n            {{ item.ship_to?.name || item.quick_ship_to?.name }} <br />\n            {{ item.ship_to?.city?.name || item.quick_ship_to?.city?.name }},\n            {{ item.ship_to?.city?.state_code || item.quick_ship_to?.city?.state_code }}\n          </td>\n        </ng-container>\n\n        <ng-container matColumnDef=\"amount\">\n          <th mat-header-cell *matHeaderCellDef>Amount</th>\n          <td mat-cell *matCellDef=\"let item\">{{ item.total | currency }}</td>\n        </ng-container>\n\n        <tr mat-header-row *matHeaderRowDef=\"displayedColumns\"></tr>\n        <tr mat-row *matRowDef=\"let row; columns: displayedColumns\"></tr>\n      </table>\n      <!-- <mat-paginator [pageSizeOptions]=\"pageSizeOptions\" aria-label=\"Select page\"> </mat-paginator> -->\n      <div *ngIf=\"!items.data.length\" class=\"table-width py-2 bg-grey-light text-center mt-n3\">No results</div>\n    </div>\n  </div>\n\n  <!-- RESULTS -->\n  <div *ngIf=\"items.data.length\" class=\"w-100 bg-grey-light p-4 rounded-lg mb-4\">\n    <div class=\"row\">\n      <span class=\"col-8 text-right\">Sub total:</span>\n      <span class=\"col-4 text-right\">{{ report?.subTotal | currency }}</span>\n    </div>\n    <div class=\"row\">\n      <span class=\"col-8 text-right\">Driver commission:</span>\n      <span class=\"col-4 text-right\">%{{ report?.driver.commission }}</span>\n    </div>\n    <div class=\"row\">\n      <span class=\"col-8 text-right\">Driver commission amount:</span>\n      <span class=\"col-4 text-right\">{{ report?.driverCommissionAmount | currency }}</span>\n    </div>\n    <div class=\"row\">\n      <span class=\"col-8 text-right\">Total units:</span>\n      <span class=\"col-4 text-right\">{{ report?.units }}</span>\n    </div>\n    <div class=\"row\">\n      <span class=\"col-8 text-right\">Weight(kg):</span>\n      <span class=\"col-4 text-right\">{{ report?.weight }}</span>\n    </div>\n    <div class=\"col-12 border border-secondary my-2\" style=\"opacity: 0.25\"></div>\n    <div class=\"row font-bold\">\n      <span class=\"col-8 text-right\">Total:</span>\n      <span class=\"col-4 text-right\">{{ report?.total | currency }}</span>\n    </div>\n  </div>\n</div>\n","import { NgModule } from \"@angular/core\";\nimport { CommonModule } from \"@angular/common\";\nimport { ReportsComponent } from \"./reports.component\";\nimport { SharedModule } from \"../shared/shared.module\";\nimport { RouterModule } from \"@angular/router\";\n\nexport const routes = [\n  {\n    path: \"\",\n    component: ReportsComponent,\n  },\n];\n\n@NgModule({\n  declarations: [ReportsComponent],\n  imports: [CommonModule, RouterModule.forChild(routes), SharedModule],\n})\nexport class ReportsModule {}\n"]}